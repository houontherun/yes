var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),GameObject=function(){function t(){}return t}();__reflect(GameObject.prototype,"GameObject");var gameUI;!function(t){var e=function(t){function e(e){var n=t.call(this)||this;return n.skinName=e,n}return __extends(e,t),e.prototype.AddClick=function(t,e,n){t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){},n),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e()},n)},e.prototype.SetImageUrl=function(t,e){var n=RES.getRes(e);n&&(t.width=n.textureWidth,t.height=n.textureHeight,t.texture=n)},e}(eui.Component);t.UIbase=e,__reflect(e.prototype,"gameUI.UIbase")}(gameUI||(gameUI={}));var Dispatcher=function(t){function e(){var e=t.call(this)||this;return e._eventMap={},e}return __extends(e,t),e.prototype.add=function(t,e,n,r){if(this.hasEventListener(t,e,n))return void console.log("repeat add Event:"+t.toString());var a=this._eventMap[t];a||(a=[],this._eventMap[t]=a),a.push({eventID:t,callback:e,thisObj:n,repeat:r})},e.prototype.addEventListener=function(t,e,n){this.add(t,e,n,-1)},e.prototype.hasEventListener=function(t,e,n){var r=this._eventMap[t];if(!r)return!1;for(var a=r.length,o=0;a>o;o++){var i=r[o];if(i&&i.callback===e&&i.thisObj===n)return!0}return!1},e.prototype.removeEventListener=function(t,e,n){for(var r=this._eventMap[t],a=r.length,o=0;a>o;o++){var i=r[o];if(i&&i.callback===e&&i.thisObj===n){r.splice(o,1);break}}},e.prototype.once=function(t,e,n){this.add(t,e,n,1)},e.prototype.removeEventListenerByTarget=function(t){for(var e in this._eventMap){var n=this._eventMap[e];this._eventMap[e]=n.filter(function(e){return!(e.thisObj===t)},this)}},e.prototype.dispatchEvent=function(t,e){var n=this._eventMap[t];if(n)for(var r=n.slice(0),a=r.length,o=a-1;o>=0;o--){var i=r[o];i.callback.call(i.thisObj,e),i.repeat>0&&(i.repeat--,i.repeat<=0&&n.splice(o,1))}},e}(GameObject);__reflect(Dispatcher.prototype,"Dispatcher");var gameUI;!function(t){var e=function(t){function e(e,n){var r=t.call(this)||this;return r.uidata=e,r.data=n,r.name=e.name,r.addEventListener(eui.UIEvent.COMPLETE,r.onload,r),r.skinName=e.skin,r}return __extends(e,t),e.prototype.onload=function(){console.log("load ui:"+this.uidata.name)},e.prototype.onUnload=function(){console.log("unload ui:"+this.uidata.name)},e.prototype.Close=function(){UIManager.Instance.UnloadUI(this.uidata)},e.prototype.AddClick=function(t,e,n){var r=t.scaleX,a=t.scaleY;t.x+=t.width/2,t.y+=t.height/2,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.scaleX=.8*r,t.scaleY=.8*a},n),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.scaleX=r,t.scaleY=a,e()},n)},Object.defineProperty(e.prototype,"UIData",{get:function(){return this.uidata},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Data",{get:function(){return this.data},enumerable:!0,configurable:!0}),e.prototype.SetImageUrl=function(t,e){var n=RES.getRes(e);n&&(t.width=n.textureWidth,t.height=n.textureWidth,t.texture=n)},e}(eui.Component);t.base=e,__reflect(e.prototype,"gameUI.base")}(gameUI||(gameUI={}));var ChatManager=function(t){function e(){var e=t.call(this)||this;return e.talkDatas=[],e}return __extends(e,t),e.prototype.Init=function(){MessageManager.Instance.addEventListener(constant.msg.SC_TALK,this.onTalk,this)},e.prototype.sendMsg=function(t){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_TALK,content:t})},e.prototype.onTalk=function(t){var e={uid:t.uid,name:t.name,content:t.content};this.talkDatas.push(e),this.dispatchEvent(constant.event.logic.on_new_chat_data,e)},Object.defineProperty(e.prototype,"Messages",{get:function(){return this.talkDatas},enumerable:!0,configurable:!0}),e.Instance=new e,e}(Dispatcher);__reflect(ChatManager.prototype,"ChatManager");var ConnectionManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"isConnected",{get:function(){return NetworkManager.Instance.isConnected},enumerable:!0,configurable:!0}),e.prototype.connect=function(t,e,n,r){this.onSucceedCallback=n,this.thisObj=r,NetworkManager.Instance.addEventListener(constant.event.network.on_connect_succeed,this.onConSucceed,this),NetworkManager.Instance.Connect(t,e)},e.prototype.onConSucceed=function(t){NetworkManager.Instance.removeEventListener(constant.event.network.on_connect_succeed,this.onConSucceed,this),this.onSucceedCallback.call(this.thisObj,t)},e.Instance=new e,e}(Dispatcher);__reflect(ConnectionManager.prototype,"ConnectionManager");var ItemData=function(){function t(t){this.id=t.ID,this.name=t.Name1,this.desc=t.Description1,this.overlay=t.OverlayNum,this.price=t.GoldPrice,this.type=t.Type,this.para1=t.Para1,this.para2=t.Para2,this.icon=t.Icon}return t}();__reflect(ItemData.prototype,"ItemData");var ChargeData=function(){function t(t){this.rmb=t.rmb,2==t.reward.length&&(this.item=DataManager.Instance.getItemInfo(t.reward[0]),this.num=t.reward[1]),2==t.presenter.length&&(this.giveItem=DataManager.Instance.getItemInfo(t.presenter[0]),this.giveNum=t.presenter[1])}return t}();__reflect(ChargeData.prototype,"ChargeData");var ShopData=function(){function t(t){this.id=t.ID,this.costType=t.Money,this.label=t.Laber,this.item=DataManager.Instance.getItemInfo(t.Item)}return t}();__reflect(ShopData.prototype,"ShopData");var DataManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getGames=function(){var t=RES.getRes("hall_json"),e={1:[],2:[],3:[]};for(var n in t.Game){var r=t.Game[n];e[r.type].push(r)}return e},e.prototype.getJsonData=function(t){var e=RES.getRes(t+"_json");return e},e.prototype.getItemInfo=function(t){var e=this.getJsonData("items");for(var n in e.Item){var r=e.Item[n];if(r.ID==t)return new ItemData(r)}return null},e.Instance=new e,e}(Dispatcher);__reflect(DataManager.prototype,"DataManager");var GameManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.Init=function(){PlayerManager.Instance.Init(),RoomManager.Instance.Init(),ChatManager.Instance.Init()},e.prototype.startDDZGame=function(){MessageManager.Instance.once(constant.msg.SC_USER_STAND_UP,this.onStandUp,this),ResourceManager.Instance.loadGroups(["ddzRes","face","poke"],this,this.onResourceLoadComplete)},e.prototype.exitDDZGame=function(){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_USER_STAND_UP})},e.prototype.onStandUp=function(){this.dispatchEvent(constant.event.logic.on_exit_game)},e.prototype.onResourceLoadComplete=function(){UIManager.Instance.LoadUI(UI.ddz_game),this.dispatchEvent(constant.event.logic.on_start_game)},e.Instance=new e,e}(Dispatcher);__reflect(GameManager.prototype,"GameManager");var HttpDownloadManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.downloadGame=function(t){var e="http://sdfdssa2221.info/patch/getpatch.php",n=new egret.HttpRequest;n.responseType=egret.HttpResponseType.ARRAY_BUFFER,n.open(e,egret.HttpMethod.GET),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(),n.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),n.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.onGetComplete=function(t){var e=t.currentTarget;console.log("down load over");var n=new JSZip(e.response);console.log(n.file("test_text.txt").asText()),console.log("read zip over")},e.prototype.onGetIOError=function(t){console.log("get error : "+t)},e.prototype.onGetProgress=function(t){console.log("get progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")},e.Instance=new e,e}(Dispatcher);__reflect(HttpDownloadManager.prototype,"HttpDownloadManager");var LoginManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.login=function(t){MessageManager.Instance.addEventListener(constant.msg.SC_LOGIN,this.onLoginRet,this),MessageManager.Instance.SendMessage({protocol:constant.msg.CS_LOGIN,openid:t})},e.prototype.onLoginRet=function(t){MessageManager.Instance.removeEventListener(constant.msg.SC_LOGIN,this.onLoginRet,this),null!=this.onLoginCallback&&this.onLoginCallback.call(this.loginObj,t),this.loginObj=null,this.onLoginCallback=null},e.prototype.loginPlatform=function(t,e,n,r){this.onLoginCallback=n,this.loginObj=r,MessageManager.Instance.addEventListener(constant.msg.SC_PLATFORM_LOGIN,this.onLoginPlatform,this),MessageManager.Instance.SendMessage({protocol:constant.msg.CS_PLATFORM_LOGIN,account:t,pwd:e})},e.prototype.onLoginPlatform=function(t){MessageManager.Instance.removeEventListener(constant.msg.SC_PLATFORM_LOGIN,this.onLoginPlatform,this),0==t.ret&&this.login(t.openid)},e.prototype.registerPlatform=function(t,e,n,r){MessageManager.Instance.addEventListener(constant.msg.SC_PLATFORM_REGISTER,this.onRegisterPlatform,this),this.onRegsiterCallback=n,this.registerObj=r,MessageManager.Instance.SendMessage({protocol:constant.msg.CS_PLATFORM_REGISTER,account:t,pwd:e})},e.prototype.onRegisterPlatform=function(t){MessageManager.Instance.removeEventListener(constant.msg.SC_PLATFORM_REGISTER,this.onRegisterPlatform,this),this.onRegsiterCallback.call(this.registerObj,t),this.onRegsiterCallback=null,this.registerObj=null},e.prototype.changePlatformPwd=function(t,e,n,r,a){MessageManager.Instance.addEventListener(constant.msg.SC_PLATFORM_CHANGE_PWD,this.onChangePlatformPwd,this),this.onChangePlatformPwdCallback=r,this.changePlatPwdObj=a,MessageManager.Instance.SendMessage({protocol:constant.msg.CS_PLATFORM_CHANGE_PWD,account:t,oldpwd:e,newpwd:n})},e.prototype.onChangePlatformPwd=function(t){MessageManager.Instance.removeEventListener(constant.msg.SC_PLATFORM_CHANGE_PWD,this.onChangePlatformPwd,this),this.onChangePlatformPwdCallback.call(this.changePlatPwdObj,t),this.onChangePlatformPwdCallback=null,this.changePlatPwdObj=null},e.Instance=new e,e}(Dispatcher);__reflect(LoginManager.prototype,"LoginManager");var MessageManager=function(t){function e(){var e=t.call(this)||this;return e.sendingList=[],e.subDispatcher=new Dispatcher,e.timer=new egret.Timer(500,0),e.timer.addEventListener(egret.TimerEvent.TIMER,e.heart,e),e.timer.start(),e}return __extends(e,t),e.prototype.heart=function(){for(var t=this.now(),e=!1,n=this.sendingList.length-1;n>=0;n--)if(this.sendingList[n].is_get_ret)this.sendingList.splice(n,1);else{var r=t-this.sendingList[n].send_time;if(r>1e3){e=!0,console.log("send "+this.sendingList[n].protocol+" wait "+this.sendingList[n].ret_protocol);break}}e?UIManager.Instance.showWait():UIManager.Instance.hideWait()},e.prototype.now=function(){return new Date},e.prototype.addSubEventListener=function(t,e,n){this.subDispatcher.addEventListener(t,e,n)},e.prototype.hasSubEventListener=function(t,e,n){return this.subDispatcher.hasEventListener(t,e,n)},e.prototype.removeSubEventListener=function(t,e,n){this.subDispatcher.removeEventListener(t,e,n)},e.prototype.removeSubEventListenerByTarget=function(t){this.subDispatcher.removeEventListenerByTarget(t)},e.prototype.DispatchMessage=function(t){for(var e=this.sendingList.length-1;e>=0;e--)this.sendingList[e].ret_protocol==t.protocol&&(this.sendingList[e].is_get_ret=!0);if(0!=t.ret)return void UIManager.Instance.showError(t.ret);var n=t.protocol;null!=n&&(n==constant.msg.SC_CHILD_GAME_MESSAGE?this.subDispatcher.dispatchEvent(t.sub_protocol,t):this.dispatchEvent(n,t))},e.prototype.SendSubMessage=function(t){t.protocol=constant.msg.CS_CHILD_GAME_MESSAGE,NetworkManager.Instance.Send(t)},e.prototype.SendMessage=function(t){NetworkManager.Instance.Send(t),void 0!=msg_data[t.protocol]&&null!=msg_data[t.protocol].ret&&this.sendingList.push({protocol:t.protocol,send_time:this.now(),ret_protocol:msg_data[t.protocol].ret,is_get_ret:!1})},e.Instance=new e,e}(Dispatcher);__reflect(MessageManager.prototype,"MessageManager");var NetworkManager=function(t){function e(){var e=t.call(this)||this;return e.initWebSocket(),e}return __extends(e,t),Object.defineProperty(e.prototype,"IP",{get:function(){return this.ip},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PORT",{get:function(){return this.port},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ClientTimestamp",{get:function(){return Math.floor(Date.now()/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ServerTimestamp",{get:function(){return Math.floor(Date.now()/1e3)},enumerable:!0,configurable:!0}),e.prototype.initWebSocket=function(){this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_BINARY,this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},e.prototype.onSocketOpen=function(){console.log("连接成功 ip="+this.ip+" port="+this.port.toString()),this.dispatchEvent(constant.event.network.on_connect_succeed)},e.prototype.onSocketClose=function(){console.log("WebSocketClose"),this.dispatchEvent(constant.event.network.on_connect_close)},e.prototype.onSocketError=function(){console.log("WebSocketError"),this.dispatchEvent(constant.event.network.on_socket_error)},e.prototype.onReceiveMessage=function(t){var e=new egret.ByteArray;this.socket.readBytes(e);var n=e.readUTFBytes(e.length);console.log(">>>> "+n);var r=JSON.parse(n);MessageManager.Instance.DispatchMessage(r)},e.prototype.Connect=function(t,e){this.ip=t,this.port=e,this.socket.connect(this.ip,this.port)},e.prototype.Send=function(t){var e=JSON.stringify(t),n=new egret.ByteArray;n.writeUTF(e),n.position=0,this.socket.writeBytes(n,2,n.bytesAvailable),console.log("<<<< "+e)},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this.socket.connected},enumerable:!0,configurable:!0}),e.Instance=new e,e}(Dispatcher);__reflect(NetworkManager.prototype,"NetworkManager");var PlayerData=function(){function t(t){this.userid=t.userid,this.gold=t.gold,this.bankgold=t.bankgold,this.diamond=t.diamond,this.card=t.card,this.openid=t.openid,this.name=t.name,this.sex=t.sex}return t.prototype.Update=function(t){void 0!=t.userid&&null!=t.userid&&(this.userid=t.userid),void 0!=t.gold&&null!=t.gold&&(this.gold=t.gold),void 0!=t.bankgold&&null!=t.bankgold&&(this.bankgold=t.bankgold),void 0!=t.diamond&&null!=t.diamond&&(this.diamond=t.diamond),void 0!=t.card&&null!=t.card&&(this.card=t.card),void 0!=t.openid&&null!=t.openid&&(this.openid=t.openid),void 0!=t.name&&null!=t.name&&(this.name=t.name),void 0!=t.sex&&null!=t.sex&&(this.sex=t.sex)},Object.defineProperty(t.prototype,"UserId",{get:function(){return this.userid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Gold",{get:function(){return this.gold},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BankGold",{get:function(){return this.bankgold},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Diamond",{get:function(){return this.diamond},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Cardnum",{get:function(){return this.card},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OpenId",{get:function(){return this.openid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Sex",{get:function(){return this.sex},enumerable:!0,configurable:!0}),t.prototype.getResourceNumById=function(t){switch(t){case 1001:return this.gold;case 1002:return this.card;default:return 0}},t}();__reflect(PlayerData.prototype,"PlayerData");var PlayerManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"Data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.updateData=function(t){this._data.Update(t),this.dispatchEvent(constant.event.logic.on_player_data_update,this._data)},e.prototype.Init=function(){MessageManager.Instance.addEventListener(constant.msg.SC_LOGIN,this.onLoginRet,this),MessageManager.Instance.addEventListener(constant.msg.SC_SAVE_MONEY,this.onSaveMoneyRet,this),MessageManager.Instance.addEventListener(constant.msg.SC_WITHDRAW_MONEY,this.onWithdrawGoldRet,this),MessageManager.Instance.addEventListener(constant.msg.SC_GIVE_GOLD_2_OTHER,this.onGiveGoldRet,this),MessageManager.Instance.addEventListener(constant.msg.SC_RECV_OTHER_GOLD,this.onReciveGold,this),MessageManager.Instance.addEventListener(constant.msg.SC_CHANGE_BANK_PASSWD,this.onModifyBankPwdRet,this),MessageManager.Instance.addEventListener(constant.msg.SC_CHARGE,this.onCharge,this),MessageManager.Instance.addEventListener(constant.msg.SC_BUY,this.onBuyItem,this)},e.prototype.onLoginRet=function(t){0==t.ret&&(this._data=new PlayerData(t),this.dispatchEvent(constant.event.logic.on_player_data_update,this._data))},e.prototype.SaveGold=function(t){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_SAVE_MONEY,gold:t})},e.prototype.onSaveMoneyRet=function(t){return 0!=t.ret?void console.log("save gold failed error code = "+t.ret):void this.updateData(t)},e.prototype.WithdrawGold=function(t){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_WITHDRAW_MONEY,gold:t})},e.prototype.onWithdrawGoldRet=function(t){return 0!=t.ret?void console.log("withdraw gold failed error code = "+t.ret):void this.updateData(t)},e.prototype.GiveGold=function(t,e){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_GIVE_GOLD_2_OTHER,gold:t,uid:e})},e.prototype.onGiveGoldRet=function(t){return 0!=t.ret?void console.log("withdraw gold failed error code = "+t.ret):void this.updateData(t)},e.prototype.onReciveGold=function(t){this.updateData(t)},e.prototype.modifyBankPwd=function(t,e){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_CHANGE_BANK_PASSWD,old:t,pwd:e})},e.prototype.onModifyBankPwdRet=function(t){0==t.ret&&UIManager.Instance.showNotice("修改成功")},e.prototype.Charge=function(t){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_CHARGE,id:t})},e.prototype.onCharge=function(t){0==t.ret&&(this.updateData(t),UIManager.Instance.showNotice("充值成功"))},e.prototype.BuyItem=function(t){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_BUY,id:t})},e.prototype.onBuyItem=function(t){0==t.ret&&(this.updateData({gold:t.gold}),UIManager.Instance.showNotice("购买成功"))},e.Instance=new e,e}(Dispatcher);__reflect(PlayerManager.prototype,"PlayerManager");var ResourceManager=function(t){function e(){var e=t.call(this)||this;return e.eventList=[],e.preloadList=[],e.current=null,e}return __extends(e,t),e.prototype.Init=function(){},e.prototype.startLoad=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onResourceItemLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(this.current)},e.prototype.endLoad=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onResourceItemLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.current=null},e.prototype.loadGroups=function(t,e,n,r,a){this.preloadList=this.preloadList.concat(t);for(var o=0,i=0;i<t.length;i++)o+=RES.getGroupByName(t[i]).length;this.eventList.push({groups:t,total:o,current:0,complete:n,progress:r,error:a,thisObj:e}),null==this.current&&(this.current=this.preloadList.pop(),this.startLoad())},e.prototype.loadGroup=function(t,e,n,r,a){this.loadGroups([t],e,n,onprogress,a)},e.prototype.onResourceLoadComplete=function(t){if(t.groupName==this.current){for(var e=this.eventList.length-1;e>=0;e--){for(var n=!0,r=0;r<this.eventList[e].groups.length;r++)if(!RES.isGroupLoaded(this.eventList[e].groups[r])){n=!1;break}n&&(this.eventList[e].complete.call(this.eventList[e].thisObj),this.eventList.splice(e,1))}this.preloadList.length>0?(this.current=this.preloadList.pop(),RES.loadGroup(this.current)):this.endLoad()}},e.prototype.onResourceProgress=function(t){if(t.groupName==this.current)for(var e=this.eventList.length-1;e>=0;e--)null!=this.eventList[e].progress&&-1!=this.eventList[e].groups.indexOf(t.groupName)&&(this.eventList[e].current+=1,this.eventList[e].progress.call(this.eventList[e].thisObj,this.eventList[e].current,this.eventList[e].total))},e.prototype.onResourceLoadError=function(t){if(t.groupName==this.current){for(var e=this.eventList.length-1;e>=0;e--)null!=this.eventList[e].error&&-1!=this.eventList[e].groups.indexOf(t.groupName)&&this.eventList[e].error.call(this.eventList[e].thisObj,t.groupName);this.onResourceLoadComplete(t)}},e.prototype.onResourceItemLoadError=function(t){t.groupName==this.current&&console.log("项目加载失败, url: "+t.resItem.url)},e.Instance=new e,e}(Dispatcher);__reflect(ResourceManager.prototype,"ResourceManager");var UserStatus;!function(t){t[t.US_NULL=0]="US_NULL",t[t.US_FREE=1]="US_FREE",t[t.US_SIT=2]="US_SIT",t[t.US_READY=3]="US_READY",t[t.US_LOOKON=4]="US_LOOKON",t[t.US_PLAYING=5]="US_PLAYING",t[t.US_OFFLINE=6]="US_OFFLINE"}(UserStatus||(UserStatus={}));var RoomData=function(){function t(t){this.player_count=t.player_count,this.room_id=t.room_id;var e=DataManager.Instance.getJsonData("hall").RoomType;for(var n in e){var r=e[n];if(r.ID==this.room_id){this.name=r.Name,this.limit=r.limit,this.gameId=r.gameID,this.baseScore=r.BaseScore;break}}}return Object.defineProperty(t.prototype,"PlayerCount",{get:function(){return this.player_count},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RoomId",{get:function(){return this.room_id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GameId",{get:function(){return this.gameId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BaseScore",{get:function(){return this.baseScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Limit",{get:function(){return this.limit},enumerable:!0,configurable:!0}),t.prototype.Update=function(t){void 0!=t.player_count&&null!=t.player_count&&(this.player_count=t.player_count),void 0!=t.room_id&&null!=t.room_id&&(this.room_id=t.room_id)},t}();__reflect(RoomData.prototype,"RoomData");var UserData=function(){function t(t){this.Previous=null,this.room_id=t.room_id,this.user_id=t.user_id,this.status=t.status,this.table_id=t.table_id,this.chair_id=t.chair_id,this.user_name=t.user_name,this.face_id=t.face_id,this.gold=t.gold}return Object.defineProperty(t.prototype,"RoomId",{get:function(){return this.room_id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UserId",{get:function(){return this.user_id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Status",{get:function(){return this.status},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TableId",{get:function(){return this.table_id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ChairId",{get:function(){return this.chair_id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UserName",{get:function(){return this.user_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FaceId",{get:function(){return this.face_id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Gold",{get:function(){return this.gold},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PrePlayer",{get:function(){return this.Previous},set:function(t){this.Previous=t},enumerable:!0,configurable:!0}),t.prototype.Update=function(t){void 0!=t.room_id&&null!=t.room_id&&(this.room_id=t.room_id),void 0!=t.user_id&&null!=t.user_id&&(this.user_id=t.user_id),void 0!=t.status&&null!=t.status&&(this.status=t.status),void 0!=t.table_id&&null!=t.table_id&&(this.table_id=t.table_id),void 0!=t.chair_id&&null!=t.chair_id&&(this.chair_id=t.chair_id),void 0!=t.user_name&&null!=t.user_name&&(this.user_name=t.user_name),void 0!=t.face_id&&null!=t.face_id&&(this.face_id=t.face_id),void 0!=t.gold&&null!=t.gold&&(this.gold=t.gold)},t}();__reflect(UserData.prototype,"UserData");var TableData=function(){function t(t,e){this.users={},this.table_id=e.table_id,this.room=t}return Object.defineProperty(t.prototype,"TableId",{get:function(){return this.table_id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Users",{get:function(){return this.users},enumerable:!0,configurable:!0}),t.prototype.UpdateUsers=function(){this.users={};for(var t=0;t<this.room.Users.length;t++)this.room.Users[t].TableId==this.table_id&&this.room.Users[t].ChairId!=constant.INVALID&&(this.users[this.room.Users[t].ChairId]=this.room.Users[t]);this.room.dispatchEvent(constant.event.logic.on_table_users_update,this)},t}();__reflect(TableData.prototype,"TableData");var EnterRoomData=function(t){function e(e){var n=t.call(this)||this;n.users=[],n.tables=[],n.tableDic={};for(var r=0;r<e.tables.length;r++){var a=new TableData(n,e.tables[r]);n.tables.push(a),n.tableDic[a.TableId]=a}for(var r=0;r<e.users.length;r++)n.AddUser(e.users[r]);return n}return __extends(e,t),e.prototype.AddUser=function(t){var e=new UserData(t);return this.users.push(e),e.TableId!=constant.INVALID&&this.tableDic[e.TableId].UpdateUsers(),e},e.prototype.RemoveUser=function(t){for(var e=this.users.length-1;e>=0;e--){var n=this.users[e];if(n.UserId==t.user_id)return this.users.splice(e,1),n.TableId!=constant.INVALID&&this.tableDic[n.TableId].UpdateUsers(),n}console.error("remove user error. not exist user:"+t.user_id)},e.prototype.UpdateUser=function(t){for(var e=this.users.length-1;e>=0;e--){var n=this.users[e];if(n.UserId==t.user_id){var r=n.TableId;return n.Update(t),r!=constant.INVALID&&n.TableId!=r&&this.tableDic[r].UpdateUsers(),n.TableId!=constant.INVALID&&this.tableDic[n.TableId].UpdateUsers(),n}}console.error("update user error. not exist user:"+t.user_id)},Object.defineProperty(e.prototype,"Tables",{get:function(){return this.tables},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Users",{get:function(){return this.users},enumerable:!0,configurable:!0}),e}(Dispatcher);__reflect(EnterRoomData.prototype,"EnterRoomData");var RoomManager=function(t){function e(){var e=t.call(this)||this;return e.roomList=[],e.currentRoom=null,e}return __extends(e,t),e.prototype.Init=function(){MessageManager.Instance.addEventListener(constant.msg.SC_ROOM_LIST,this.onRoomListRet,this),MessageManager.Instance.addEventListener(constant.msg.SC_ENTER_ROOM,this.onEnterRoomRet,this),MessageManager.Instance.addEventListener(constant.msg.SC_QUERY_ROOM_INFO,this.onQueryRoomInfoRet,this),MessageManager.Instance.addEventListener(constant.msg.SC_LEAVE_ROOM,this.onLeaveRoomRet,this),MessageManager.Instance.addEventListener(constant.msg.SC_PLAYER_ENTER_ROOM,this.onPlayerEnterRoom,this),MessageManager.Instance.addEventListener(constant.msg.SC_PLAYER_LEAVE_ROOM,this.onPlayerLeaveRoom,this),MessageManager.Instance.addEventListener(constant.msg.SC_USER_SIT_DOWN,this.onPlayerSitDown,this),MessageManager.Instance.addEventListener(constant.msg.SC_USER_STATUS,this.onPlayerStateUpdate,this),MessageManager.Instance.addEventListener(constant.msg.SC_USER_STAND_UP,this.onPlayerStandup,this),MessageManager.Instance.addEventListener(constant.msg.SC_CREATE_HALL_TABLE,this.onCreateCustomTable,this),MessageManager.Instance.addEventListener(constant.msg.SC_JOIN_CUSTOM_TABLE,this.onJoinCustomTable,this)},e.prototype.onRoomListRet=function(t){this.roomList=[];for(var e=0;e<t.room_list.length;e++){var n=new RoomData(t.room_list[e]);this.roomList.push(n)}},Object.defineProperty(e.prototype,"RoomList",{get:function(){return this.roomList},enumerable:!0,configurable:!0}),e.prototype.EnterRoom=function(t){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_ENTER_ROOM,room_id:t})},e.prototype.onEnterRoomRet=function(t){0==t.ret&&this.dispatchEvent(constant.event.logic.on_self_enter_room)},e.prototype.queryRoomInfo=function(){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_QUERY_ROOM_INFO})},e.prototype.onQueryRoomInfoRet=function(t){0==t.ret&&(this.currentRoom=new EnterRoomData(t),this.dispatchEvent(constant.event.logic.on_query_room_info,this.currentRoom))},e.prototype.LevelRoom=function(){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_LEAVE_ROOM})},e.prototype.onLeaveRoomRet=function(t){0==t.ret&&(this.dispatchEvent(constant.event.logic.on_self_leave_room,this.currentRoom),this.currentRoom=null)},e.prototype.onPlayerEnterRoom=function(t){if(0==t.ret&&null!=this.currentRoom&&void 0!=this.currentRoom){var e=this.currentRoom.AddUser(t);this.dispatchEvent(constant.event.logic.on_player_enter_room,e)}},e.prototype.onPlayerLeaveRoom=function(t){if(0==t.ret&&null!=this.currentRoom&&void 0!=this.currentRoom){var e=this.currentRoom.RemoveUser(t);this.dispatchEvent(constant.event.logic.on_player_leave_room,e)}},e.prototype.SitDown=function(t,e){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_USER_SIT_DOWN,table_id:t,chair_id:e})},e.prototype.onPlayerSitDown=function(t){0==t.ret&&this.dispatchEvent(constant.event.logic.on_self_sit_down,this.currentRoom)},e.prototype.Standup=function(){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_USER_STAND_UP})},e.prototype.onPlayerStandup=function(t){0==t.ret&&this.dispatchEvent(constant.event.logic.on_self_stand_up,this.currentRoom)},e.prototype.onPlayerStateUpdate=function(t){if(0==t.ret&&null!=this.currentRoom&&void 0!=this.currentRoom){var e=this.currentRoom.UpdateUser(t);this.dispatchEvent(constant.event.logic.on_player_data_update,e)}},e.prototype.CreateCustomTable=function(t,e,n,r){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_CREATE_HALL_TABLE,game_id:t,ticket_pay_type:e,round_count:n,time_limit:r})},e.prototype.onCreateCustomTable=function(t){this.dispatchEvent(constant.event.logic.on_create_custom_table,t)},e.prototype.JoinCustomTable=function(t){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_JOIN_CUSTOM_TABLE,custom_table_id:t})},e.prototype.onJoinCustomTable=function(t){this.dispatchEvent(constant.event.logic.on_join_custom_table,t)},e.Instance=new e,e}(Dispatcher);__reflect(RoomManager.prototype,"RoomManager");var UI={login:{name:"gameUI.login",skin:"resource/custom_skins/loginSkin.exml"},lobby:{name:"gameUI.lobby",skin:"resource/custom_skins/lobbySkin.exml"},setting:{name:"gameUI.setting",skin:"resource/custom_skins/settingSkin.exml"},bank:{name:"gameUI.bank",skin:"resource/custom_skins/bankSkin.exml"},rank:{name:"gameUI.rank",skin:"resource/custom_skins/rankSkin.exml"},create_room:{name:"gameUI.create_room",skin:"resource/custom_skins/create_roomSkin.exml"},enter_room:{name:"gameUI.enter_room",skin:"resource/custom_skins/enter_roomSkin.exml"},ddzSelectRoom:{name:"gameUI.ddzSelectRoom",skin:"resource/custom_skins/games/ddzSelectRoomSkin.exml"},ddzRoom:{name:"gameUI.ddzRoom",skin:"resource/custom_skins/games/ddzRoomSkin.exml"},ddz_game:{name:"gameUI.ddz_game",skin:"resource/custom_skins/ddz_ui/ui_game.exml"},register:{name:"gameUI.register",skin:"resource/custom_skins/registerSkin.exml"},modifyPwd:{name:"gameUI.modifyPwd",skin:"resource/custom_skins/ModifyPwdSkin.exml"},phoneRegister:{name:"gameUI.phoneRegister",skin:"resource/custom_skins/phoneRegisterSkin.exml"},forgetPwd:{name:"gameUI.forgetPwd",skin:"resource/custom_skins/phoneRegisterSkin.exml"},chat:{name:"gameUI.chat",skin:"resource/custom_skins/chatSkin.exml"},shop:{name:"gameUI.shop",skin:"resource/custom_skins/shopSkin.exml"},loading:{name:"gameUI.loading",skin:"resource/custom_skins/loadingSkin.exml"}},UIManager=function(t){function e(){var e=t.call(this)||this;
return e.stage=null,e.waitImg=null,e.waitMask=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"Lobby",{get:function(){var t=this.GetChild(UI.lobby);if(null!=t){var e=t;return e}return null},enumerable:!0,configurable:!0}),e.prototype.Init=function(t){this.stage=t},e.prototype.LoadUI=function(t,e,n,r){if(!egret.hasDefinition(t.name))return void console.error("not found ui name:"+t.name);var a=egret.getDefinitionByName(t.name),o=new a(t,e);null!=n&&null!=r&&o.once(eui.UIEvent.COMPLETE,n,r),o.percentHeight=100,o.percentWidth=100,this.stage.addChild(o)},e.prototype.UnloadUI=function(t){var e=this.stage.getChildByName(t.name);null!=e&&(e.onUnload(),this.stage.removeChild(e),e=null)},e.prototype.GetChild=function(t){return this.stage.getChildByName(t.name)},e.prototype.showError=function(t){return void 0==error_data[t]?void alert("没有找到错误描述 error="+t.toString()):void alert(error_data[t].msg)},e.prototype.showNotice=function(t){alert(t)},e.prototype.showWait=function(){if(null==this.waitImg){this.waitImg=new eui.Image("loading_png"),this.waitImg.x=this.stage.width/2,this.waitImg.y=this.stage.height/2,this.waitImg.anchorOffsetX=43.5,this.waitImg.anchorOffsetY=43.5,this.stage.addChild(this.waitImg);var t=egret.Tween.get(this.waitImg,{loop:!0});t.to({rotation:360},1e3),this.waitMask=new eui.Image("mask_png"),this.waitMask.width=this.stage.width,this.waitMask.height=this.stage.height,this.waitMask.alpha=.01,this.stage.addChild(this.waitMask)}this.waitImg.visible=!0,this.waitMask.visible=!0},e.prototype.hideWait=function(){null!=this.waitImg&&(this.waitImg.visible=!1,this.waitMask.visible=!1)},e.Instance=new e,e}(Dispatcher);__reflect(UIManager.prototype,"UIManager");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function r(r){e.call(n,r,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?r(a):RES.getResAsync(t,r,this)}else RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var GameController=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(GameObject);__reflect(GameController.prototype,"GameController");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,r){function a(t){e.call(r,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(r))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Card;!function(t){t.MASK_COLOR=240,t.MASK_VALUE=15,t.PackCards={1:{weight:12,name:"A"},2:{weight:13,name:"2"},3:{weight:1,name:"3"},4:{weight:2,name:"4"},5:{weight:3,name:"5"},6:{weight:4,name:"6"},7:{weight:5,name:"7"},8:{weight:6,name:"8"},9:{weight:7,name:"9"},10:{weight:8,name:"10"},11:{weight:9,name:"J"},12:{weight:10,name:"Q"},13:{weight:11,name:"K"},14:{weight:14,name:"SK"},15:{weight:15,name:"BK"}};var e;!function(t){t[t.PASS_TYPE=-1]="PASS_TYPE",t[t.ERROR_TYPE=0]="ERROR_TYPE",t[t.SINGLE_TYPE=1]="SINGLE_TYPE",t[t.PAIR_TYPE=2]="PAIR_TYPE",t[t.TRIO_TYPE=3]="TRIO_TYPE",t[t.TRIOSINGLE_TYPE=4]="TRIOSINGLE_TYPE",t[t.TRIODOUBLE_TYPE=5]="TRIODOUBLE_TYPE",t[t.STRAIGHT_TYPE=6]="STRAIGHT_TYPE",t[t.CONPAIR_TYPE=7]="CONPAIR_TYPE",t[t.AEROPLANE_TYPE=8]="AEROPLANE_TYPE",t[t.AEROPLANES_TYPE=9]="AEROPLANES_TYPE",t[t.AEROPLANEL_TYPE=10]="AEROPLANEL_TYPE",t[t.FOURSINGLE_TYPE=11]="FOURSINGLE_TYPE",t[t.FOURDOUBLE_TYPE=12]="FOURDOUBLE_TYPE",t[t.BOMB_TYPE=14]="BOMB_TYPE",t[t.NUKE_TYPE=16]="NUKE_TYPE"}(e=t.CardTypes||(t.CardTypes={}));var n=function(){function t(t){this.group=[],this.cards=t.sort(this.sortCard),this.group=i.groupCards(this.cards),this.cardType=this.getCardType()}return t.prototype.sortCard=function(t,e){return t.Weight-e.Weight},Object.defineProperty(t.prototype,"CardType",{get:function(){return this.cardType},enumerable:!0,configurable:!0}),t.prototype.isPress=function(t){return this.cardType==e.ERROR_TYPE||t.cardType==e.ERROR_TYPE?!1:this.cardType==e.NUKE_TYPE?!0:t.cardType==e.NUKE_TYPE?!1:this.cardType==e.BOMB_TYPE?t.cardType==e.BOMB_TYPE?this.cards[0].Weight>t.cards[0].Weight:!0:t.cardType==e.BOMB_TYPE?!1:this.cardType!=t.cardType?!1:this.cardType==e.SINGLE_TYPE||this.cardType==e.PAIR_TYPE||this.cardType==e.TRIO_TYPE?this.cards[0].Weight>t.cards[0].Weight:this.cardType==e.TRIOSINGLE_TYPE||this.cardType==e.TRIODOUBLE_TYPE||this.cardType==e.FOURSINGLE_TYPE||this.cardType==e.FOURDOUBLE_TYPE?this.group[0].weight>t.group[0].weight:this.cardType==e.STRAIGHT_TYPE||this.cardType==e.CONPAIR_TYPE||this.cardType==e.AEROPLANE_TYPE?this.cards.length!=t.cards.length?!1:this.cards[0].Weight>t.cards[0].Weight:this.cardType==e.AEROPLANES_TYPE||this.cardType==e.AEROPLANEL_TYPE?this.cards.length!=t.cards.length?!1:this.group[0].weight>t.group[0].weight:void 0},Object.defineProperty(t.prototype,"Cards",{get:function(){return this.cards},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Group",{get:function(){return this.group},enumerable:!0,configurable:!0}),t.prototype.getCardType=function(){return this.isSINGLE_TYPE()?e.SINGLE_TYPE:this.isNUKE_TYPE()?e.NUKE_TYPE:this.isBOMB_TYPE()?e.BOMB_TYPE:this.isPAIR_TYPE()?e.PAIR_TYPE:this.isTRIO_TYPE()?e.TRIO_TYPE:this.isTRIOSINGLE_TYPE()?e.TRIOSINGLE_TYPE:this.isTRIODOUBLE_TYPE()?e.TRIODOUBLE_TYPE:this.isSTRAIGHT_TYPE()?e.STRAIGHT_TYPE:this.isCONPAIR_TYPE()?e.CONPAIR_TYPE:this.isAEROPLANE_TYPE()?e.AEROPLANE_TYPE:this.isAEROPLANES_TYPE()?e.AEROPLANES_TYPE:this.isAEROPLANEL_TYPE()?e.AEROPLANEL_TYPE:this.isFOURSINGLE_TYPE()?e.FOURSINGLE_TYPE:this.isFOURDOUBLE_TYPE()?e.FOURDOUBLE_TYPE:e.ERROR_TYPE},t.prototype.isSINGLE_TYPE=function(){return 1==this.cards.length},t.prototype.isPAIR_TYPE=function(){return 2==this.cards.length&&this.cards[0].Weight==this.cards[1].Weight},t.prototype.isTRIO_TYPE=function(){return 3==this.cards.length&&this.cards[0].Weight==this.cards[1].Weight&&this.cards[1].Weight==this.cards[2].Weight},t.prototype.isTRIOSINGLE_TYPE=function(){return 4==this.cards.length&&2==this.group.length&&3==this.group[0].count?!0:!1},t.prototype.isTRIODOUBLE_TYPE=function(){return 5==this.cards.length&&2==this.group.length&&3==this.group[0].count&&2==this.group[1].count?!0:!1},t.prototype.isSTRAIGHT_TYPE=function(){if(this.cards.length<5)return!1;var t=this.cards[0],e=this.cards[this.cards.length-1];if(t.Weight<1||e.Weight>12)return!1;for(var n=0;n<this.cards.length-1;n++)if(this.cards[n].Weight!=this.cards[n+1].Weight-1)return!1;return!0},t.prototype.isCONPAIR_TYPE=function(){if(this.cards.length<6||this.cards.length%2!=0)return!1;if(this.group.length<3)return!1;for(var t=0;t<this.group.length-1;t++){if(2!=this.group[t].count||2!=this.group[t+1].count)return!1;if(this.group[t].weight>12||this.group[t+1].weight>12)return!1;if(this.group[t].weight!=this.group[t+1].weight-1)return!1}return!0},t.prototype.isAEROPLANE_TYPE=function(){if(this.cards.length<6||this.cards.length%3!=0)return!1;if(this.group.length<2)return!1;for(var t=0;t<this.group.length-1;t++){if(3!=this.group[t].count||3!=this.group[t+1].count)return!1;if(this.group[t].weight>12||this.group[t+1].weight>12)return!1;if(this.group[t].weight!=this.group[t+1].weight-1)return!1}return!0},t.prototype.isAEROPLANES_TYPE=function(){if(this.cards.length<8||this.cards.length%4!=0)return!1;if(this.group.length<3)return!1;for(var t=this.cards.length/4,e=0;t-1>e;e++){if(3!=this.group[e].count||3!=this.group[e+1].count)return!1;if(this.group[e].weight>12||this.group[e+1].weight>12)return!1;if(this.group[e].weight!=this.group[e+1].weight-1)return!1}return!0},t.prototype.isAEROPLANEL_TYPE=function(){if(this.cards.length<10||this.cards.length%5!=0)return!1;if(this.group.length<4)return!1;for(var t=this.cards.length/5,e=0;t-1>e;e++){if(3!=this.group[e].count||3!=this.group[e+1].count)return!1;if(this.group[e].weight>12||this.group[e+1].weight>12)return!1;if(this.group[e].weight!=this.group[e+1].weight-1)return!1}for(var e=t;e<this.group.length;e++)if(2!=this.group[e].count)return!1;return!0},t.prototype.isFOURSINGLE_TYPE=function(){return 6!=this.cards.length?!1:3!=this.group.length&&2!=this.group.length?!1:4==this.group[0].count},t.prototype.isFOURDOUBLE_TYPE=function(){return 8!=this.cards.length?!1:3!=this.group.length?!1:4==this.group[0].count&&2==this.group[1].count&&2==this.group[2].count},t.prototype.isBOMB_TYPE=function(){return 4==this.cards.length&&this.cards[0].Weight==this.cards[1].Weight&&this.cards[1].Weight==this.cards[2].Weight&&this.cards[2].Weight==this.cards[3].Weight},t.prototype.isNUKE_TYPE=function(){return 2==this.cards.length&&this.cards[0].Weight>=14&&this.cards[1].Weight>=15},t}();t.ddzPackCardGroup=n,__reflect(n.prototype,"Card.ddzPackCardGroup");var r=function(){function t(t){this.groups=null,this.updateCards(t)}return t.prototype.updateCards=function(t){this.cards=this.sortSingleCards(t),this.groupCards()},t.prototype.sortSingleCards=function(t){return t.sort(function(t,e){return t.Weight-e.Weight})},t.prototype.sortArrayCards=function(t){return t.sort(function(t,e){return t[0].Weight-e[0].Weight})},t.prototype.groupCards=function(){if(!(this.cards.length<1)){this.groups={1:[],2:[],3:[],4:[],5:[]};for(var t=[this.cards[0]],e=1;e<this.cards.length;e++)this.cards[e].Index==t[t.length-1].Index||14==t[t.length-1].Index&&15==this.cards[e].Index?t.push(this.cards[e]):(this.addToGroup(t),t=[],t.push(this.cards[e]));t.length>0&&this.addToGroup(t)}},t.prototype.addToGroup=function(t){1==t.length?this.groups[1].push(t[0]):2==t.length?14==t[0].Index||15==t[0].Index?this.groups[5]=t:this.groups[2].push(t):3==t.length?this.groups[3].push(t):4==t.length&&this.groups[4].push(t)},t.prototype.subCardList=function(t){for(var e=[],n=0,r=this.sortSingleCards(t),a=0;a<this.cards.length;a++)r.length>n&&r[n].Index==this.cards[a].Index?n++:e.push(this.cards[a]);return e},t.prototype.toPokerArray=function(t){for(var e=[],n=0;n<t.length;n++)e=e.concat(t[n]);return e},t.prototype.getSingles=function(){var t=[];t=t.concat(this.groups[1]);for(var e=0;e<this.groups[2].length;e++)t.push(this.groups[2][e][0]);for(var e=0;e<this.groups[3].length;e++)t.push(this.groups[3][e][0]);for(var e=0;e<this.groups[4].length;e++)t.push(this.groups[4][e][0]);return t=t.concat(this.groups[5])},t.prototype.getPairs=function(){var t=[];t=t.concat(this.groups[2]);for(var e=0;e<this.groups[3].length;e++)t.push([this.groups[3][e][0],this.groups[3][e][1]]);for(var e=0;e<this.groups[4].length;e++)t.push([this.groups[4][e][0],this.groups[4][e][1]]);return t},t.prototype.getTrebles=function(){var t=[];t=t.concat(this.groups[3]);for(var e=0;e<this.groups[4].length;e++)t.push([this.groups[4][e][0],this.groups[4][e][1],this.groups[4][e][2]]);return t},t.prototype.getQuadruples=function(){var t=[];return t=t.concat(this.groups[4])},t.prototype.getStraights=function(){for(var t=[],e=[],n=this.sortSingleCards(this.getSingles()),r=0;r<n.length;r++)n[r].Weight>=1&&n[r].Weight<=12&&(0==e.length?e.push(n[r]):e[e.length-1].Weight==n[r].Weight-1?e.push(n[r]):(e.length>=5&&t.push(e),e=[]));return e.length>=5&&t.push(e),e=[],t},t.prototype.getConpairs=function(){for(var t=[],e=[],n=this.sortArrayCards(this.getPairs()),r=0;r<n.length;r++)n[r][0].Weight>=1&&n[r][0].Weight<=12&&(0==e.length?e.push(n[r]):e[e.length-1][0].Weight==n[r][0].Weight-1?e.push(n[r]):(e.length>=3&&t.push(e),e=[]));return e.length>=3&&t.push(e),e=[],t},t.prototype.getAeroplanes=function(){for(var t=[],e=[],n=this.sortArrayCards(this.getTrebles()),r=0;r<n.length;r++)n[r][0].Weight>=1&&n[r][0].Weight<=12&&(0==e.length?e.push(n[r]):e[e.length-1][0].Weight==n[r][0].Weight-1?e.push(n[r]):(e.length>=2&&t.push(e),e=[]));return e.length>=2&&t.push(e),e=[],t},t.prototype.getBombs=function(){for(var t=[],e=this.getQuadruples(),n=0;n<e.length;n++)t.push(e[n]);return this.groups[5].length>0&&t.push(this.groups[5]),t},t.prototype.getPressedCards=function(n){var r=n.CardType,a=n.Cards[0],o=[];switch(r){case e.SINGLE_TYPE:for(var i=this.getSingles(),s=0;s<i.length;s++)i[s].Weight>a.Weight&&o.push([i[s]]);var c=this.getBombs();o=o.concat(c);break;case e.PAIR_TYPE:for(var h=this.getPairs(),s=0;s<h.length;s++)h[s][0].Weight>a.Weight&&o.push(h[s]);var c=this.getBombs();o=o.concat(c);break;case e.TRIO_TYPE:for(var d=this.getTrebles(),s=0;s<d.length;s++)d[s][0].Weight>a.Weight&&o.push(d[s]);var c=this.getBombs();o=o.concat(c);break;case e.TRIOSINGLE_TYPE:for(var d=this.getTrebles(),s=0;s<d.length;s++)if(d[s][0].Weight>a.Weight){var u=[],l=d[s],g=this.subCardList(l),p=new t(g),i=p.getSingles();i.length>0&&(u=u.concat(l),u.push(i[0]),o.push(u))}var c=this.getBombs();o=o.concat(c);break;case e.TRIODOUBLE_TYPE:for(var d=this.getTrebles(),s=0;s<d.length;s++)if(d[s][0].Weight>a.Weight){var _=[],l=d[s],g=this.subCardList(l),p=new t(g),h=p.getPairs();h.length>0&&(_=_.concat(l),_=_.concat(h[0]),o.push(_))}var c=this.getBombs();o=o.concat(c);break;case e.STRAIGHT_TYPE:for(var m=this.getStraights(),s=0;s<m.length;s++)if(m[s].length>=n.Cards.length)for(var f=0;f<m[s].length;f++)if(m[s][f].Weight>a.Weight&&m[s].length-f>=n.Cards.length){var v=m[s].slice(f,f+n.Cards.length);o.push(v)}var c=this.getBombs();o=o.concat(c);break;case e.CONPAIR_TYPE:for(var C=this.getConpairs(),E=n.Cards.length/2,s=0;s<C.length;s++)if(C[s].length>=E)for(var f=0;f<C[s].length;f++)if(C[s][f][0].Weight>a.Weight&&C[s].length-f>=E){var I=C[s].slice(f,f+E);o.push(this.toPokerArray(I))}var c=this.getBombs();o=o.concat(c);break;case e.AEROPLANE_TYPE:for(var y=this.getAeroplanes(),E=n.Cards.length/3,s=0;s<y.length;s++)if(y[s].length>=E)for(var f=0;f<y[s].length;f++)if(y[s][f][0].Weight>a.Weight&&y[s].length-f>=E){var R=y[s].slice(f,f+E);o.push(this.toPokerArray(R))}var c=this.getBombs();o=o.concat(c);break;case e.AEROPLANES_TYPE:for(var y=this.getAeroplanes(),E=n.Cards.length/4,s=0;s<y.length;s++)if(y[s].length>=E)for(var f=0;f<y[s].length;f++)if(y[s][f][0].Weight>a.Weight&&y[s].length-f>=E){var R=y[s].slice(f,f+E),S=this.toPokerArray(R),g=this.subCardList(S),p=new t(g),i=p.getSingles();if(i.length>=E){var b=[];b=b.concat(S),b=b.concat(i.slice(0,E)),o.push(b)}}var c=this.getBombs();o=o.concat(c);break;case e.AEROPLANEL_TYPE:for(var y=this.getAeroplanes(),E=n.Cards.length/5,s=0;s<y.length;s++)if(y[s].length>=E)for(var f=0;f<y[s].length;f++)if(y[s][f][0].Weight>a.Weight&&y[s].length-f>=E){var R=y[s].slice(f,f+E),S=this.toPokerArray(R),g=this.subCardList(S),p=new t(g),h=p.getPairs();if(h.length>=E){var T=[];T=T.concat(S),T=T.concat(h.slice(0,E)),o.push(T)}}var c=this.getBombs();o=o.concat(c);break;case e.FOURSINGLE_TYPE:for(var L=this.getQuadruples(),s=0;s<L.length;s++)if(L[s][0].Weight>a.Weight){for(var S=L[s],g=this.subCardList(S),p=new t(g),U=[],s=0;s<p.groups[1].length&&U.length<2;s++)U.push(p.groups[1][s]);if(U.length<2)for(var O=2;4>=O;O++)for(var s=0;s<p.groups[O].length;s++)for(var f=0;O>f&&U.length<2;f++)U.push(p.groups[O][s][f]);if(U.length<2)for(var s=0;s<p.groups[5].length&&U.length<2;s++)U.push(p.groups[5][s]);if(U.length>=2){var A=[];A=A.concat(S),A=A.concat(U),o.push(A)}}var c=this.getBombs();o=o.concat(c);break;case e.FOURDOUBLE_TYPE:for(var L=this.getQuadruples(),s=0;s<L.length;s++)if(L[s][0].Weight>a.Weight){var S=L[s],g=this.subCardList(S),p=new t(g),h=p.getPairs();if(h.length>=2){var P=[];P=P.concat(S),P=P.concat(h[0]),P=P.concat(h[1]),o.push(P)}}var c=this.getBombs();o=o.concat(c);break;case e.BOMB_TYPE:for(var L=this.getQuadruples(),s=0;s<L.length;s++)L[s][0].Weight>a.Weight&&o.push(L[s]);this.groups[5].length>0&&o.push(this.groups[5]);break;case e.NUKE_TYPE:}return o},t}();t.ddzHandCards=r,__reflect(r.prototype,"Card.ddzHandCards");var a;!function(t){t[t.Farmer=0]="Farmer",t[t.Landlord=1]="Landlord"}(a=t.Identity||(t.Identity={}));var o;!function(t){t[t.Left=0]="Left",t[t.Right=1]="Right"}(o=t.Seat||(t.Seat={}));var i=function(){function e(){}return e.GetCardValue=function(e){return e&t.MASK_VALUE},e.GetCardColor=function(e){return(e&t.MASK_COLOR)>>4},e.GetSCCarddata=function(t){return(t.Suit<<4)+t.Index},e.createPokerCard=function(e,n){var r=e,a=n,o=null;r>0&&(o=t.PackCards[e]);var i=new PokerCard(r,a,o);return i},e.sortCards=function(t){return t.sort(function(t,e){return e.Weight-t.Weight})},e.groupCards=function(e){for(var n={},r=[],a=0;a<e.length;a++)void 0==n[e[a].Index]&&(n[e[a].Index]=0),n[e[a].Index]++;for(var o in n)r.push({index:o,count:n[o],weight:t.PackCards[o].weight});return r=r.sort(function(e,n){return e.count!=n.count?n.count-e.count:t.PackCards[e.index].weight-t.PackCards[n.index].weight})},e}();t.Util=i,__reflect(i.prototype,"Card.Util")}(Card||(Card={}));var CardColor;!function(t){t[t.Diamond=0]="Diamond",t[t.Heart=1]="Heart",t[t.Club=2]="Club",t[t.Spade=3]="Spade",t[t.SK=4]="SK"}(CardColor||(CardColor={}));var PokerCard=function(){function t(t,e,n){this.color=CardColor.Diamond,this.index=0,this.name="",this.weight=0,this.index=t,this.color=e,n&&(this.name=n.name,this.weight=n.weight)}return Object.defineProperty(t.prototype,"Suit",{get:function(){return this.color},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Index",{get:function(){return this.index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return null!=this.name?this.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Weight",{get:function(){return this.weight},enumerable:!0,configurable:!0}),t}();__reflect(PokerCard.prototype,"PokerCard");var CardLogic;!function(t){var e=function(t){function e(e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),t.call(this,e,n,r)||this}return __extends(e,t),e.DispatchCardStart="dispatchcardstart",e.AddOtherPlayers="addotherPlayers",e.AddHard="addhard",e.UpdatePlayers="updatePlayers",e}(egret.Event);t.CardEvent=e,__reflect(e.prototype,"CardLogic.CardEvent")}(CardLogic||(CardLogic={}));var CardLogic;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"Instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e}(egret.EventDispatcher);t.CardEventDispatcher=e,__reflect(e.prototype,"CardLogic.CardEventDispatcher")}(CardLogic||(CardLogic={}));var CardLogic;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.bStartgame=!1,t.StartgameTick=0,t.players=[],t.playerChairid=0,t.playerposInfo={},t.landUser=-1,t.PressedCards=[],t.hardCardList=[],t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return null==n.shared&&(n.shared=new n),n.shared},enumerable:!0,configurable:!0}),n.prototype.init=function(){this.timer=new egret.Timer(100),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onUpdateFrame,this),this.timer.start(),this.timerTick=t.Timer.Instance.tick,this.UpdatePlayersEvent=new t.CardEvent(t.CardEvent.UpdatePlayers),MessageManager.Instance.addSubEventListener(constant.sub_msg.SUB_S_SEND_CARD,this.DispatchCardStart,this),MessageManager.Instance.addEventListener(constant.msg.SC_TABLE_PLAYER_INFO,this.UpdatePlayers,this),MessageManager.Instance.SendMessage({protocol:constant.msg.CS_QUERY_TABLE_USER_INFO})},Object.defineProperty(n.prototype,"ALLPlayers",{get:function(){return this.players},enumerable:!0,configurable:!0}),n.prototype.GetPlayer=function(t){for(var e=null,n=0;n<this.players.length;n++)if(t==this.players[n].ChairId)return this.players[n];return e},n.prototype.UpdatePlayers=function(e){this.players=[];for(var n=null,r=0;r<e.players.length;r++){var a=new UserData(e.players[r]);n&&(a.PrePlayer=n),r==e.players.length-1&&r>0&&(this.players[0].PrePlayer=a),n=a,this.players.push(a)}t.CardEventDispatcher.Instance.dispatchEvent(this.UpdatePlayersEvent)},n.prototype.Addcard=function(t){var e=[CardColor.Diamond,CardColor.Heart,CardColor.Club,CardColor.Spade,CardColor.SK],n=Card.Util.GetCardColor(t),r=e[n],a=Card.Util.GetCardValue(t),o=Card.Util.createPokerCard(a,r);return this.hardCardList.push(o),o},n.prototype.getindex=function(t,e){for(var n=-1,r=0;r<this.hardCardList.length;r++)if(this.hardCardList[r].Index==t&&this.hardCardList[r].Suit==e)return r;return n},n.prototype.GetIndex=function(t){var e=this.getindex(t.Index,t.Suit);return e},n.prototype.Removecard=function(t){var e=[CardColor.Diamond,CardColor.Heart,CardColor.Club,CardColor.Spade,CardColor.SK],n=Card.Util.GetCardColor(t),r=e[n],a=Card.Util.GetCardValue(t),o=this.getindex(a,r);return o>-1?(this.hardCardList.splice(o,1),!0):!1},n.prototype.ExitGame=function(){this.bStartgame=!1,this.StartgameTick=0,this.timer.stop(),MessageManager.Instance.removeEventListener(constant.msg.SC_TABLE_PLAYER_INFO,this.UpdatePlayers,this),MessageManager.Instance.removeSubEventListener(constant.sub_msg.SUB_S_SEND_CARD,this.DispatchCardStart,this)},n.prototype.ResetGame=function(){this.bStartgame=!1,this.StartgameTick=0,this.timer.reset()},n.prototype.onUpdateFrame=function(){null!=this.timerTick&&this.timerTick(),this.StartgameTick++},Object.defineProperty(n.prototype,"HandCards",{get:function(){return this.hardCardList},enumerable:!0,configurable:!0}),n.prototype.DispatchCardStart=function(e){this.hardCardList=[];var n=[CardColor.Diamond,CardColor.Heart,CardColor.Club,CardColor.Spade,CardColor.SK];this.bStartgame=!0;for(var r=e.cards[this.playerChairid],a=0;a<r.length;a++)if(0!=r[a]){var o=Card.Util.GetCardColor(r[a]),i=n[o],s=Card.Util.GetCardValue(r[a]),c=Card.Util.createPokerCard(s,i);this.hardCardList.push(c)}var h=new t.CardEvent(t.CardEvent.AddHard);h.paramObj=this.hardCardList,t.CardEventDispatcher.Instance.dispatchEvent(h)},n.prototype.GetPokerCards=function(t){for(var e=[],n=[CardColor.Diamond,CardColor.Heart,CardColor.Club,CardColor.Spade,CardColor.SK],r=0;r<t.length;r++)if(0!=t[r]){var a=Card.Util.GetCardColor(t[r]),o=n[a],i=Card.Util.GetCardValue(t[r]),s=Card.Util.createPokerCard(i,o);e.push(s)}return e},n.prototype.GetPressedCards=function(){return this.PressedCards},n.prototype.GenPressedCards=function(t){var e=this.GetPokerCards(t);if(e.length<1)return null;var n=new Card.ddzPackCardGroup(e),r=new Card.ddzHandCards(this.hardCardList);this.PressedCards=r.getPressedCards(n),Card.Util.sortCards(this.hardCardList)},n}(Dispatcher);t.ddzGameLogic=e,__reflect(e.prototype,"CardLogic.ddzGameLogic")}(CardLogic||(CardLogic={}));var CardLogic;!function(t){var e=function(){function t(t,e,n,r){this.stop=!1,this.remove=!1,this.locked=!1,this.tick=0,this.args=null,this.func=e,this.seconds=t,this.num=n,this.args=r}return Object.defineProperty(t.prototype,"Locked",{get:function(){return this.locked},set:function(t){this.locked=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Remove",{get:function(){return this.remove},set:function(t){this.remove=t},enumerable:!0,configurable:!0}),t.prototype.recycle=function(){this.args=null,this.func=null},t.prototype.Tick=function(t){this.stop||this.locked||(this.tick=this.tick+t,this.tick>=this.seconds&&(this.tick=0,this.locked=!0,null!=this.func&&this.func(this.args),this.locked=!1,this.num>0&&(this.num=this.num-1,this.num<=0&&(this.remove=!0,this.stop=!0))))},t}();__reflect(e.prototype,"TimerInfo");var n=function(){function t(){var t=this;this.timers=[],this.tick=function(){for(var e=0,n=t.timers;e<n.length;e++){var r=n[e];if(r.Remove||r.Locked){var a=t.timers.indexOf(r);a>-1&&t.timers.splice(a,1),r.recycle(),r=null}else r.Tick(.1)}}}return Object.defineProperty(t,"Instance",{get:function(){return null==t.instance&&(t.instance=new t),t.instance},enumerable:!0,configurable:!0}),t.prototype.Delay=function(t,n,r){var a=new e(t,n,1,r);return this.timers.push(a),a},t.prototype.Repeat=function(t,n,r){var a=new e(t,n,0,r);return this.timers.push(a),a},t.prototype.Numberal=function(t,n,r,a){var o=new e(t,n,r,a);return this.timers.push(o),o},t.prototype.Remove=function(t){t&&(t.Remove=!0)},t}();t.Timer=n,__reflect(n.prototype,"CardLogic.Timer")}(CardLogic||(CardLogic={}));var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isResourceLoadEnd=!1,e.isThemeLoadEnd=!1,e}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),this.scaleX=this.scaleY=1.438,egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var n=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",n),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter);var r=new egret.ImageLoader;r.addEventListener(egret.Event.COMPLETE,function(t){var n=t.target,r=n.data,a=new egret.Texture;a.bitmapData=r;var o=new egret.Bitmap(a);o.alpha=0,e.addChild(o);var i=egret.Tween.get(o);i.to({alpha:1},1e3)},this);var a="resource/assets/logo.jpg";r.load(a);var o=new egret.Timer(1500,1);o.addEventListener(egret.TimerEvent.TIMER,function(){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,e.onConfigComplete,e),RES.loadConfig("resource/default.res.json","resource/")},this),o.start()},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),ResourceManager.Instance.Init(),UIManager.Instance.Init(this),GameManager.Instance.Init();var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),ResourceManager.Instance.loadGroups(["login","data"],this,this.onResourceLoaded)},e.prototype.onResourceLoaded=function(){this.isResourceLoadEnd=!0,this.createScene()},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},e.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&UIManager.Instance.LoadUI(UI.login)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var gameUI;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hardCardsArray=[],e.PlayersNum=3,e.TargetCardsArray=[],e.cardBegin=-1,e.cardEnd=-1,e.cardItemArray={},e.buchuItemArray={},e.cdTimer=null,e.newCurrentCards=[],e.promptIndex=0,e}return __extends(e,t),e.prototype.onload=function(){var e=this;t.prototype.onload.call(this),MessageManager.Instance.addEventListener(constant.msg.SC_USER_READY,this.ReadyRet,this),MessageManager.Instance.addSubEventListener(constant.sub_msg.SUB_S_LAND_SCORE,this.landScore,this),MessageManager.Instance.addSubEventListener(constant.sub_msg.SUB_S_GAME_START,this.StartGame,this),MessageManager.Instance.addSubEventListener(constant.sub_msg.SUB_S_OUT_CARD,this.OutCard,this),MessageManager.Instance.addSubEventListener(constant.sub_msg.SUB_S_PASS_CARD,this.PassCard,this),MessageManager.Instance.addSubEventListener(constant.sub_msg.SUB_S_GAME_END,this.GameEnd,this),MessageManager.Instance.addSubEventListener(constant.sub_msg.SUB_S_TRUSTEE,this.Trustee,this),CardLogic.ddzGameLogic.Instance.init(),CardLogic.CardEventDispatcher.Instance.addEventListener(CardLogic.CardEvent.AddHard,this.AddhardCard,this),CardLogic.CardEventDispatcher.Instance.addEventListener(CardLogic.CardEvent.UpdatePlayers,this.SetplayersInfo,this),this.AddClick(this.btn_tuoguan,function(){},this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.SendReady,this),this.AddClick(this.btn_back,function(){GameManager.Instance.addEventListener(constant.event.logic.on_exit_game,function(){e.Close(),CardLogic.ddzGameLogic.Instance.ExitGame()},e),GameManager.Instance.exitDDZGame()},this),this.Text_bnt0.visible=!1,this.btn0.visible=!1},e.prototype.SendReady=function(){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_USER_READY})},e.prototype.SendSnatchlandLord=function(){MessageManager.Instance.SendSubMessage({sub_protocol:constant.sub_msg.SUB_C_LAND_SCORE,score:1})},e.prototype.SendUnSnatchlandLord=function(){MessageManager.Instance.SendSubMessage({sub_protocol:constant.sub_msg.SUB_C_LAND_SCORE,score:0})},e.prototype.Sendpasscard=function(){MessageManager.Instance.SendSubMessage({sub_protocol:constant.sub_msg.SUB_C_PASS_CARD})},e.prototype.SendOutcard=function(){for(var t=[],e=0,n=this.GetShootCard();e<n.length;e++){var r=n[e];t.push(Card.Util.GetSCCarddata(r))}var a=t.length;MessageManager.Instance.SendSubMessage({sub_protocol:constant.sub_msg.SUB_C_OUT_CART,cards:t,card_count:a}),t=[]},e.prototype.onUnload=function(){t.prototype.onUnload.call(this),MessageManager.Instance.removeEventListener(constant.msg.SC_USER_READY,this.ReadyRet,this),MessageManager.Instance.removeSubEventListener(constant.sub_msg.SUB_S_LAND_SCORE,this.landScore,this),MessageManager.Instance.removeSubEventListener(constant.sub_msg.SUB_S_GAME_START,this.StartGame,this),MessageManager.Instance.removeSubEventListener(constant.sub_msg.SUB_S_OUT_CARD,this.OutCard,this),MessageManager.Instance.removeSubEventListener(constant.sub_msg.SUB_S_PASS_CARD,this.PassCard,this),MessageManager.Instance.removeSubEventListener(constant.sub_msg.SUB_S_GAME_END,this.GameEnd,this),MessageManager.Instance.removeSubEventListener(constant.sub_msg.SUB_S_TRUSTEE,this.Trustee,this),CardLogic.CardEventDispatcher.Instance.removeEventListener(CardLogic.CardEvent.AddHard,this.AddhardCard,this),CardLogic.CardEventDispatcher.Instance.removeEventListener(CardLogic.CardEvent.UpdatePlayers,this.SetplayersInfo,this)},e.prototype.GetGroupChairid=function(t){var e,n;CardLogic.ddzGameLogic.Instance.playerChairid==t?(e=this.group_Player0,n=0):(n=CardLogic.ddzGameLogic.Instance.playerposInfo[t],e=this.getChildAt(n+2));e.getChildByName("Label_pos");return e},e.prototype.AddBackCard=function(t){this.hardCardsArray.length>0&&this.removehardCard();for(var e=[],n=0;n<t.length;n++)e.push(CardLogic.ddzGameLogic.Instance.Addcard(t[n]));Card.Util.sortCards(CardLogic.ddzGameLogic.Instance.HandCards);for(var r=CardLogic.ddzGameLogic.Instance.HandCards,n=0;n<r.length;n++){var a=new Card.ui_pokerCardItem;a.cardData=r[n],a.setPos(45*n,16),this.group_handcards.addChild(a),this.AddTohardCardsArray(a);var o=e.indexOf(r[n]);o>-1&&a.SetShoot(!0)}},e.prototype.OutCard=function(t){this.SetBtnsGame(!1),this.PlayerOutCard(t.chair_id,t.cards,t.card_count);var e=CardLogic.ddzGameLogic.Instance.playerChairid;this.newCurrentCards=t.cards,t.current_user==e&&(this.promptIndex=0,CardLogic.ddzGameLogic.Instance.GenPressedCards(this.newCurrentCards),this.PlayermeOutCard()),t.current_user!=constant.INVALID&&this.countdown(t.current_user,t.time)},e.prototype.GameEnd=function(t){for(var e=this,n=[],r=0;r<t.names.length;r++){var a=new Card.PlayerRankData(t.names[r],t.golds[r],t.base_score,t.user_time[r]);n.push(a)}var o=new Card.ui_GameSettle(t.result,n);this.addChild(o),o.SetContinueclick(function(){e.removeChild(o),o=null,e.clearCurGame(),e.restart()}),o.SetExitClick(function(){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_USER_STAND_UP}),e.removeChild(o),o=null})},e.prototype.PassCard=function(t){if(t.chair_id!=constant.INVALID){var e=t.chair_id,n=this.GetGroupChairid(e);if(this.cardItemArray&&null!=this.cardItemArray[e])for(var r=0,a=this.cardItemArray[e];r<a.length;r++){var o=a[r];n.removeChild(o)}this.cardItemArray[e]=[],this.buchuItemArray&&this.buchuItemArray[e]&&n.removeChild(this.buchuItemArray[e]),this.buchuItemArray[e]=null;var i=n.getChildByName("Label_pos"),s=new eui.Image;s.source=RES.getRes("buchu_png"),i.x<10?s.x=i.x-60:s.x=i.x,s.y=i.y,n.addChild(s),this.buchuItemArray[e]=s,e==CardLogic.ddzGameLogic.Instance.playerChairid&&this.CancelShootCard()}this.SetBtnsGame(!1),this.countdown(t.current_user,t.time);var c=CardLogic.ddzGameLogic.Instance.playerChairid;t.current_user==c&&(CardLogic.ddzGameLogic.Instance.GenPressedCards(this.newCurrentCards),this.PlayermeOutCard(t.new_turn))},e.prototype.Trustee=function(t){},e.prototype.prompt=function(){var t=CardLogic.ddzGameLogic.Instance.GetPressedCards();if(t.length>0){for(var e=0;e<this.hardCardsArray.length;e++)this.hardCardsArray[e].SetShoot(!1);this.promptIndex==t.length&&(this.promptIndex=0);for(var n=0;n<t[this.promptIndex].length;n++){var r=t[this.promptIndex][n],a=CardLogic.ddzGameLogic.Instance.GetIndex(r);
this.hardCardsArray[a].SetShoot(!0)}this.promptIndex++}},e.prototype.PlayermeOutCard=function(t){void 0===t&&(t=0),this.SetBtnsGame(!0),this.Text_bnt1.text="不出",this.Text_bnt0.text="出牌",this.Text_bnt2.text="提示",this.btn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.SendSnatchlandLord,this),this.btn0.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.SendUnSnatchlandLord,this),this.btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.Sendpasscard,this),this.btn0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.SendOutcard,this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.prompt,this);var e=CardLogic.ddzGameLogic.Instance.playerChairid;if(0==t){var n=CardLogic.ddzGameLogic.Instance.GetPressedCards();n.length<1&&(this.SetBtnsGame(!1),this.Text_bnt1.visible=!0,this.btn1.visible=!0,this.Text_bnt1.x=330,this.btn1.x=315)}else this.SetBtnsGame(!1),this.Text_bnt0.visible=!0,this.btn0.visible=!0,this.Text_bnt0.x=330,this.btn0.x=315;if(this.buchuItemArray&&this.buchuItemArray[e]&&this.group_Player0.removeChild(this.buchuItemArray[e]),this.buchuItemArray[e]=null,this.cardItemArray&&null!=this.cardItemArray[e])for(var r=0,a=this.cardItemArray[e];r<a.length;r++){var o=a[r];this.group_Player0.removeChild(o)}this.cardItemArray[e]=[]},e.prototype.StartGame=function(t){var e=t.land_score;this.txt_gamedouble.text=e.toString(),CardLogic.ddzGameLogic.Instance.landUser=t.land_user;var n=CardLogic.ddzGameLogic.Instance.playerChairid;if(t.last_user!=constant.INVALID){var r=this.GetGroupChairid(t.last_user),a=r.getChildByName("Label_pos"),o=new eui.Image;1==t.land_score?o.source=RES.getRes("qiangdizhuzhi_png"):0==t.land_score&&(o.source=RES.getRes("buqiang_png")),o.x=a.x,o.y=a.y,r.addChild(o),CardLogic.Timer.Instance.Delay(3.2,function(){r.removeChild(o)})}if(t.land_user!=constant.INVALID){var i=this.GetGroupChairid(t.land_user),s=new eui.Image;s.source=RES.getRes("dizhumao_png"),s.y=0,s.x=12,i.addChild(s)}t.land_user==n&&(this.AddBackCard(t.back_card),this.PlayermeOutCard(1));for(var c=CardLogic.ddzGameLogic.Instance.GetPokerCards(t.back_card),h=0;h<c.length;h++){var d=new Card.ui_pokerCardItem;d.SetSize(.7),d.cardData=c[h],this.group_backcards.addChild(d)}this.countdown(t.land_user,t.time)},e.prototype.SetBtnsGame=function(t){this.Text_bnt1.visible=t,this.btn1.visible=t,this.Text_bnt2.visible=t,this.btn2.visible=t,this.Text_bnt0.visible=t,this.btn0.visible=t,this.btn0.x=480,this.btn1.x=87,this.btn2.x=315,this.Text_bnt0.x=495,this.Text_bnt1.x=101,this.Text_bnt2.x=330},e.prototype.landScore=function(t){if(t.land_user!=constant.INVALID){var e=this.GetGroupChairid(t.land_user),n=e.getChildByName("Label_pos"),r=new eui.Image;1==t.land_score?r.source=RES.getRes("qiangdizhuzhi_png"):0==t.land_score&&(r.source=RES.getRes("buqiang_png")),r.x=n.x-30,r.y=n.y,e.addChild(r),CardLogic.Timer.Instance.Delay(3.2,function(){e.removeChild(r)})}t.current_user!=constant.INVALID&&(this.countdown(t.current_user,t.time),t.current_user==CardLogic.ddzGameLogic.Instance.playerChairid?(this.Text_bnt2.text="不抢",this.SetBtnsGame(!0),this.Text_bnt1.text="抢地主",this.Text_bnt0.visible=!1,this.btn0.visible=!1,this.btn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.SendReady,this),this.btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.SendSnatchlandLord,this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.SendUnSnatchlandLord,this)):this.SetBtnsGame(!1))},e.prototype.ReadyRet=function(t){0==t.ret&&(this.Text_bnt2.text="已准备",this.Text_bnt1.visible=!1,this.btn1.visible=!1)},e.prototype.countdown=function(t,e){var n=this;this.clockCD||(this.clockCD=new Card.ui_ClockCD);var r,a;if(CardLogic.ddzGameLogic.Instance.playerChairid==t?(r=this.group_Player0,a=0):(a=CardLogic.ddzGameLogic.Instance.playerposInfo[t],r=this.getChildAt(a+2)),this.cdTimer&&(CardLogic.Timer.Instance.Remove(this.cdTimer),this.cdTimer=null),r&&this.curClockpos!=a){var o=r.getChildByName("Label_pos");this.clockCD.x=o.x-33,this.clockCD.y=o.y-60,this.clockCD.visible=!0,r.addChild(this.clockCD),this.curClockpos=a,this.cdTimer=CardLogic.Timer.Instance.Repeat(1,function(){var t=e-NetworkManager.Instance.ServerTimestamp;t>0&&n.clockCD?n.clockCD.SetCd(t):(CardLogic.Timer.Instance.Remove(n.cdTimer),n.cdTimer=null,n.clockCD&&(n.clockCD.visible=!1))})}},e.prototype.DelayTimer=function(t){this.clockCD&&this.clockCD.SetCd(t)},e.prototype.getrelativeChair=function(t){var e=0,n=(CardLogic.ddzGameLogic.Instance.ALLPlayers,CardLogic.ddzGameLogic.Instance.playerChairid),r=CardLogic.ddzGameLogic.Instance.GetPlayer(n);if(null==r)return-1;for(;e<this.PlayersNum;){if(r.ChairId==t)return e;r=r.PrePlayer,e++}return-1},e.prototype.SetplayersInfo=function(){this.clearPlayers(!0),this.group_otherPlayersHead.removeChildren();var t=CardLogic.ddzGameLogic.Instance.ALLPlayers;if(t.length>0){for(var e=0;e<t.length;e++)t[e].UserId==PlayerManager.Instance.Data.UserId&&(CardLogic.ddzGameLogic.Instance.playerChairid=t[e].ChairId);for(var e=0;e<t.length;e++)if(t[e].UserId==PlayerManager.Instance.Data.UserId)this.setPlayer(0,t[e].UserName,t[e].Gold,"face_1_png"),CardLogic.ddzGameLogic.Instance.playerposInfo[t[e].ChairId]=0;else{var n=this.getrelativeChair(t[e].ChairId);n>-1&&(this.setPlayer(n,t[e].UserName,t[e].Gold,"face_2_png"),CardLogic.ddzGameLogic.Instance.playerposInfo[t[e].ChairId]=n)}}},e.prototype.PlayerOutCard=function(t,e,n){var r=CardLogic.ddzGameLogic.Instance.GetPokerCards(e),a=this.GetGroupChairid(t),o=a.getChildByName("Label_pos"),i=0;i=o.x-30;var s=24;if(i=o.x,10>i&&(i-=30*r.length),this.cardItemArray&&null!=this.cardItemArray[t])for(var c=0,h=this.cardItemArray[t];c<h.length;c++){var d=h[c];a.removeChild(d)}if(this.cardItemArray[t]=[],this.buchuItemArray&&this.buchuItemArray[t]&&a.removeChild(this.buchuItemArray[t]),this.buchuItemArray[t]=null,t==CardLogic.ddzGameLogic.Instance.playerChairid)s=o.y-25;else{var u=a.getChildAt(6);u&&(u.text=n.toString())}for(var l=0;l<r.length;l++){var g=new Card.ui_pokerCardItem;g.cardData=r[l],g.setPos(i+30*l,s),g.SetSize(.75),a.addChild(g),l==r.length-1&&t==CardLogic.ddzGameLogic.Instance.landUser&&g.Setlandlord(!0),this.cardItemArray[t].push(g)}if(t==CardLogic.ddzGameLogic.Instance.playerChairid){for(var p=0,_=e;p<_.length;p++){var m=_[p];CardLogic.ddzGameLogic.Instance.Removecard(m)}this.hardCardsArray.length>0&&this.removehardCard(),this.group_handcards.removeChildren();for(var f=CardLogic.ddzGameLogic.Instance.HandCards,l=0;l<f.length;l++){var g=new Card.ui_pokerCardItem;g.cardData=f[l],g.setPos(45*l,16),this.group_handcards.addChild(g),this.AddTohardCardsArray(g)}}},e.prototype.setPlayer=function(t,e,n,r){var a;if(a=t>0?this.getChildAt(t+2):this.group_Player0){var o=a.getChildAt(1);if(o.text=e,t>0){var i=a.getChildAt(2);i.text=n.toString()}else this.txt_PlayerGold.text=n.toString();a.visible=!0}var s=new eui.Image;s.source=RES.getRes(r),2>t?s.x=10:s.x=this.group_otherPlayersHead.width-300,t>0?this.group_otherPlayersHead.addChild(s):a.addChildAt(s,0)},e.prototype.dealtoPlayer=function(t,e){var n,r,a=this;if(t>0){if(n=this.getChildAt(t+2),8==n.numChildren)r=n.getChildAt(6),r.text="1";else{var o=new eui.Image;o.scaleX=o.scaleY=.56,o.source=RES.getRes("card_back_png"),n.addChildAt(o,5),r=new eui.Label,r.fontFamily="SimHei",r.strokeColor=255,r.stroke=2,r.text="1",r.textAlign=egret.HorizontalAlign.CENTER,e==Card.Seat.Left?(o.x=250,o.y=200,r.x=278,r.y=240):(o.x=0,o.y=200,r.x=30,r.y=240),n.addChildAt(r,6)}var i=1;if(r)var s=CardLogic.Timer.Instance.Repeat(.18,function(){i<a.cardTotalnum?(r.text=i.toString(),i++):CardLogic.Timer.Instance.Remove(s)})}},e.prototype.OpenDeal=function(){var t=this;this.Text_bnt2.visible=!1,this.btn2.visible=!1;var e=new eui.Image,n=4;this.AddClick(e,function(){MessageManager.Instance.SendSubMessage({sub_protocol:constant.sub_msg.SUB_C_BRIGHT,chair_id:CardLogic.ddzGameLogic.Instance.playerChairid})},this),e.source=RES.getRes("btn2_png"),e.width=138.75,e.height=63.75,e.x=this.group_btn.width/2+20,e.y=14,this.group_btn.addChild(e);var r=new eui.Label;r.fontFamily="SimHei",r.textColor=170,r.text="明牌×8",r.size=30,r.x=this.group_btn.width/2+36,r.y=e.y+13.5,r.textAlign=egret.HorizontalAlign.CENTER,this.group_btn.addChild(r);var a=CardLogic.Timer.Instance.Repeat(1.2,function(){n>0?(r.text="明牌×"+n.toString(),n-=2):(CardLogic.Timer.Instance.Remove(a),t.group_btn.removeChild(r),t.group_btn.removeChild(e))})},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this)},e.prototype.AddTohardCardsArray=function(t){this.hardCardsArray.push(t),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this)},e.prototype.InTargetCards=function(t){for(var e=this.hardCardsArray.length-1;e>=0;e--)if(t==this.hardCardsArray[e])return e;return-1},e.prototype.touchBegin=function(t){this.TargetCardsArray=[];var e=this.InTargetCards(t.currentTarget);this.cardBegin=e},e.prototype.touchMove=function(t){var e=this.InTargetCards(t.currentTarget);this.cardEnd=e,this.moving()},e.prototype.touchEnd=function(t){this.CheckEnd()},e.prototype.CheckEnd=function(){if(!(this.cardBegin<0||this.cardEnd<0)&&this.cardBegin!=this.cardEnd){this.cardBegin<this.cardEnd?this.TargetCardsArray=this.hardCardsArray.slice(this.cardBegin,this.cardEnd+1):this.TargetCardsArray=this.hardCardsArray.slice(this.cardEnd,this.cardBegin+1);for(var t=0;t<this.TargetCardsArray.length;t++)this.TargetCardsArray[t].alpha=1,this.TargetCardsArray[t].SetShoot(!this.TargetCardsArray[t].Selected);this.TargetCardsArray=[],this.cardEnd=this.cardBegin=-1}},e.prototype.moving=function(){if(!(this.cardBegin<0||this.cardEnd<0)){this.cardBegin<this.cardEnd?this.TargetCardsArray=this.hardCardsArray.slice(this.cardBegin,this.cardEnd+1):this.TargetCardsArray=this.hardCardsArray.slice(this.cardEnd,this.cardBegin+1);for(var t=0;t<this.hardCardsArray.length;t++)this.hardCardsArray[t].alpha=1;for(var t=0;t<this.TargetCardsArray.length;t++)this.TargetCardsArray[t].alpha=.8}},e.prototype.GetShootCard=function(){for(var t=[],e=0;e<this.hardCardsArray.length;e++)this.hardCardsArray[e].Selected&&t.push(this.hardCardsArray[e].cardData);return t},e.prototype.CancelShootCard=function(){for(var t=0;t<this.hardCardsArray.length;t++)this.hardCardsArray[t].Selected&&this.hardCardsArray[t].SetShoot(!1)},e.prototype.AddhardCard=function(t){var e=this;this.hardCardsArray.length>0&&this.removehardCard(),this.OpenDeal();var n=t.paramObj;Card.Util.sortCards(n),this.cardTotalnum=n.length;var r=0,a=CardLogic.Timer.Instance.Repeat(.18,function(){if(r<e.cardTotalnum){var t=new Card.ui_pokerCardItem;t.cardData=n[r],t.setPos(45*r,16),e.group_handcards.addChild(t),e.AddTohardCardsArray(t),r++}else CardLogic.Timer.Instance.Remove(a),e.childrenCreated()});this.group_handcards.cacheAsBitmap=!0,this.AddotherCard()},e.prototype.AddotherCard=function(){this.dealtoPlayer(1,Card.Seat.Left),this.dealtoPlayer(2,Card.Seat.Right)},e.prototype.removehardCard=function(){for(var t=0;t<this.hardCardsArray.length;t++)this.group_handcards.removeChild(this.hardCardsArray[t]);this.hardCardsArray=[]},e.prototype.clearPlayers=function(t){void 0===t&&(t=!1);for(var e=0,n=1;n<this.PlayersNum;n++){var r=this.getChildAt(n+2);for(e=5;r.numChildren>e;)r.removeChildAt(r.numChildren-1);r.visible=!1}for(e=4,t&&(this.group_Player0.numChildren>3&&this.group_Player0.removeChildAt(0),e=3);this.group_Player0.numChildren>e;)this.group_Player0.removeChildAt(this.group_Player0.numChildren-1)},e.prototype.restart=function(){this.SetBtnsGame(!0),this.Text_bnt1.text="换桌",this.Text_bnt2.text="准备",this.Text_bnt0.visible=!1,this.btn0.visible=!1,this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.SendReady,this)},e.prototype.clearCurGame=function(){this.hardCardsArray.length>0&&this.removehardCard(),this.group_backcards.removeChildren(),this.clearPlayers(),this.btn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.Sendpasscard,this),this.btn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.SendOutcard,this),this.cardItemArray={},this.buchuItemArray={},this.clockCD&&(this.clockCD=null),this.txt_gamedouble.text="1"},e}(t.base);t.ddz_game=e,__reflect(e.prototype,"gameUI.ddz_game")}(gameUI||(gameUI={}));var Card;!function(t){var e=function(){function t(t,e,n,r){this.baseScore=n,this.Playername=t,this.usertimes=r,this.gold=e}return Object.defineProperty(t.prototype,"Gold",{get:function(){return this.gold},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UserTime",{get:function(){return this.usertimes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this.Playername},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BaseScore",{get:function(){return this.baseScore},enumerable:!0,configurable:!0}),t}();t.PlayerRankData=e,__reflect(e.prototype,"Card.PlayerRankData");var n=function(t){function e(){var e=t.call(this)||this;return e.isLoaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e.skinName="resource/custom_skins/ddz_ui/PlayerRank.exml",e}return __extends(e,t),e.prototype.onload=function(){this.isLoaded=!0,this.updateUI()},e.prototype.dataChanged=function(){this.updateUI()},e.prototype.updateUI=function(){this.isLoaded&&null!=this.data&&(this.text_name.text=this.data.Name,this.text_baseScore.text=this.data.BaseScore.toString(),this.text_gold.text=this.data.Gold.toString(),this.text_times.text=this.data.UserTime.toString())},e}(eui.ItemRenderer);__reflect(n.prototype,"ddz_SettleItemRander");var r=function(t){function e(e,n){var r=t.call(this)||this;return r.gameresult=!1,r.rankData=[],r.gameresult=e,r.rankData=n,r.addEventListener(eui.UIEvent.COMPLETE,r.onload,r),r.skinName="resource/custom_skins/ddz_ui/ui_gameSettle.exml",r}return __extends(e,t),e.prototype.SetContinueclick=function(t){this.Continue=t},e.prototype.SetExitClick=function(t){this.ExitRoom=t},e.prototype.onload=function(){var t=this;this.gameresult?(this.img_result_title.source="shengli_png",this.img_result1_bg.visible=!0,this.img_result0_bg.visible=!1):(this.img_result_title.source="sibai_png",this.img_result0_bg.visible=!0,this.img_result1_bg.visible=!1),this.list_PlayersRank.dataProvider=new eui.ArrayCollection(this.rankData),this.list_PlayersRank.itemRenderer=n,this.AddClick(this.btn_continue,function(){t.Continue&&t.Continue()},this),this.AddClick(this.btn_exit,function(){t.ExitRoom&&t.ExitRoom()},this)},e}(gameUI.UIbase);t.ui_GameSettle=r,__reflect(r.prototype,"Card.ui_GameSettle")}(Card||(Card={}));var Card;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.delay=-1,e.skinName="resource/custom_skins/ddz_ui/ui_ClockCD.exml",e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e}return __extends(e,t),e.prototype.onload=function(){this.delay>-1&&(this.text_cd.text=this.delay.toString())},e.prototype.SetCd=function(t){this.delay=t,this.text_cd&&(this.text_cd.text=t.toString())},e}(eui.Component);t.ui_ClockCD=e,__reflect(e.prototype,"Card.ui_ClockCD",["eui.UIComponent","egret.DisplayObject"])}(Card||(Card={}));var Card;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e}(eui.Component);__reflect(e.prototype,"ui_playerItem",["eui.UIComponent","egret.DisplayObject"])}(Card||(Card={}));var Card;!function(t){var e=function(t){function e(){var e=t.call(this,"resource/custom_skins/ddz_ui/ui_pokerCard.exml")||this;return e.bSelect=!1,e.bLandLord=!1,e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onclick_tap,e),e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e}return __extends(e,t),e.prototype.onload=function(){null!=this.card&&(this.SetImageUrl(this.img_card,this.imgsource),this.img_landlord.visible=this.bLandLord)},Object.defineProperty(e.prototype,"cardData",{get:function(){return this.card},set:function(t){this.card=t;var e=t.Index,n=t.Suit,r="";r=e>0&&16>e&&n>=0&&4>=n?"card_"+n+"_"+e+"_png":"card_back_png",this.imgsource=r,this.img_card&&this.SetImageUrl(this.img_card,this.imgsource)},enumerable:!0,configurable:!0}),e.prototype.SetSize=function(t){this.scaleX=t,this.scaleY=t},Object.defineProperty(e.prototype,"Selected",{get:function(){return this.bSelect},enumerable:!0,configurable:!0}),e.prototype.setPos=function(t,e){this.x=t,this.y=e,this.posY=e},e.prototype.onclick_tap=function(){this.bSelect=!this.bSelect,this.alpha=1,this.bSelect?this.y-=20:this.y=this.posY},e.prototype.SetShoot=function(t){this.bSelect=t,this.bSelect?this.y-=20:this.y=this.posY},e.prototype.Setlandlord=function(t){this.bLandLord=t,this.img_landlord.visible=this.bLandLord},e}(gameUI.UIbase);t.ui_pokerCardItem=e,__reflect(e.prototype,"Card.ui_pokerCardItem",["eui.UIComponent","egret.DisplayObject"])}(Card||(Card={}));var Util=function(){function t(){}return t.formatNum=function(t){console.log("num:"+t);for(var e=Math.floor(t),n=Math.floor(100*(t-e)),r=e.toString(),a=[];r.length>3;)a.push(r.slice(r.length-3,r.length)),r=r.substr(0,r.length-3);for(var o=a.length-1;o>=0;o--)r+=","+a[o];return n>0&&(r+="."+n.toString()),console.log("res "+r),r},t.getItem=function(t){return egret.localStorage.getItem(t)},t.setItem=function(t,e){return egret.localStorage.setItem(t,e)},t}();__reflect(Util.prototype,"Util");var gameUI;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isLoaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e.skinName="resource/custom_skins/bankOperItemSkin.exml",e}return __extends(e,t),e.prototype.onload=function(){this.isLoaded=!0,this.updateUI()},e.prototype.updateUI=function(){null!=this.data&&this.isLoaded&&(this.txtDate.text=this.data.t.toString(),this.txtSendId.text=this.data.guid.toString(),this.txtRecvId.text=this.data.ruid.toString(),this.txtNumber.text=this.data.gold.toString())},e.prototype.dataChanged=function(){this.updateUI()},e}(eui.ItemRenderer);__reflect(e.prototype,"rankItemRander");var n="bank_tab_png",r="bank_tab2_png",a=15897626,o=7819298,i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentTabIndex=-1,e}return __extends(i,t),i.prototype.setGiveNum=function(t){PlayerManager.Instance.Data.Gold>=t?this.txtGiveNum.text=t.toString():UIManager.Instance.showNotice("金币不够")},i.prototype.onload=function(){var n=this;t.prototype.onload.call(this),this.AddClick(this.imgIn,function(){var t=parseInt(n.txtInNum.text);PlayerManager.Instance.SaveGold(t)},this),this.AddClick(this.imgOut,function(){var t=parseInt(n.txtInNum.text);PlayerManager.Instance.WithdrawGold(t)},this),this.AddClick(this.imgGiveOK,function(){if(null==n.txtGiveId.text||""==n.txtGiveId.text||null==n.txtGiveNum.text||""==n.txtGiveNum.text)return void UIManager.Instance.showNotice("请填写ID或金额");var t=parseInt(n.txtGiveId.text),e=parseInt(n.txtGiveNum.text);PlayerManager.Instance.GiveGold(e,t)},this),this.AddClick(this.imgTenW,function(){n.setGiveNum(1e5)},this),this.AddClick(this.imgOneQW,function(){n.setGiveNum(1e7)},this),this.AddClick(this.imgTenFiveBW,function(){n.setGiveNum(5e6)},this),this.AddClick(this.imgOneBaiW,function(){n.setGiveNum(1e6)},this),this.AddClick(this.imgOneYi,function(){n.setGiveNum(1e8)},this),this.AddClick(this.btnClose,function(){n.Close()},this),this.imgTabGS.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.loadTab(0)},this),this.imgTabGive.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.loadTab(1)},this),this.imgTabRecord.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.loadTab(2)},this),this.tabBtns=[this.imgTabGS,this.imgTabGive,this.imgTabRecord],this.tabText=[this.txtTabGS,this.txtTabGive,this.txtTabRecord],this.tabGroup=[this.groupGS,this.groupGive,this.groupRecord],this.loadTab(0),this.svRecords.initItemRenderer(e),this.svRecords.initItemSkin("resource/custom_skins/bankOperItemSkin.exml"),PlayerManager.Instance.addEventListener(constant.event.logic.on_player_data_update,this.updateUI,this),this.updateUI(PlayerManager.Instance.Data),MessageManager.Instance.addEventListener(constant.msg.SC_GET_BANK_RECORD,this.onGetBankRecord,this),this.getBankRecord(0)},i.prototype.onUnload=function(){t.prototype.onUnload.call(this),MessageManager.Instance.removeEventListener(constant.msg.SC_GET_BANK_RECORD,this.onGetBankRecord,this)},i.prototype.updateUI=function(t){this.txtCurrent.text=Util.formatNum(t.Gold),this.txtTotel.text=Util.formatNum(t.BankGold.toString())},i.prototype.loadTab=function(t){if(this.currentTabIndex!=t){this.currentTabIndex=t;for(var e=0;3>e;e++)e==this.currentTabIndex?(this.tabBtns[e].source=n,this.tabText[e].textColor=a,this.tabGroup[e].visible=!0):(this.tabBtns[e].source=r,this.tabText[e].textColor=o,this.tabGroup[e].visible=!1)}},i.prototype.getBankRecord=function(t){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_GET_BANK_RECORD,begin:t})},i.prototype.onGetBankRecord=function(t){0==t.ret&&this.svRecords.bindData(t.list)},i}(t.base);t.bank=i,__reflect(i.prototype,"gameUI.bank")}(gameUI||(gameUI={}));var constant={connect_ip:"47.96.11.32",connect_port:8e3,msg:{CS_PLATFORM_REGISTER:1988,CS_PLATFORM_LOGIN:1989,CS_PLATFORM_CHANGE_PWD:1990,CS_LOGIN:1001,CS_CREATE_ROOM:1002,CS_ENTER_ROOM:1003,CS_LEAVE_ROOM:1004,CS_LOGOUT:1005,CS_SAVE_MONEY:1006,CS_WITHDRAW_MONEY:1007,CS_GIVE_GOLD_2_OTHER:1008,CS_CHANGE_BANK_PASSWD:1020,CS_GET_BANK_RECORD:1021,CS_GET_RANK:1022,CS_QUERY_TABLE_USER_INFO:1024,CS_USER_SIT_DOWN:1009,CS_USER_STAND_UP:1010,CS_USER_READY:1011,CS_CHILD_GAME_MESSAGE:1012,CS_QUERY_ROOM_INFO:1013,CS_MODIFY_USER_INFO:1023,CS_REENTER_PLAYING:1025,CS_CREATE_HALL_TABLE:1026,CS_JOIN_CUSTOM_TABLE:1027,CS_TALK:1040,CS_CHARGE:1050,CS_BUY:1052,CS_MAX:1999,SC_PLATFORM_REGISTER:2988,SC_PLATFORM_LOGIN:2989,SC_PLATFORM_CHANGE_PWD:2990,SC_LOGIN:2001,SC_CREATE_ROOM:2002,SC_ENTER_ROOM:2003,SC_LEAVE_ROOM:2004,SC_PLAYER_ENTER_ROOM:2005,SC_PLAYER_LEAVE_ROOM:2006,SC_LOGOUT:2007,SC_ROOM_LIST:2008,SC_SAVE_MONEY:2009,SC_WITHDRAW_MONEY:2010,SC_GIVE_GOLD_2_OTHER:2011,SC_RECV_OTHER_GOLD:2012,SC_CHANGE_BANK_PASSWD:2020,SC_GET_BANK_RECORD:2021,SC_GET_RANK:2022,SC_USER_SIT_DOWN:2013,SC_TABLE_INFO:2014,SC_USER_STATUS:2015,SC_USER_STAND_UP:2016,SC_USER_READY:2017,SC_CHILD_GAME_MESSAGE:2018,SC_GAME_MESSAGE:2019,SC_QUERY_ROOM_INFO:2023,SC_MODIFY_USER_INFO:2024,SC_TABLE_PLAYER_INFO:2025,SC_USER_IS_PLAYING:2026,SC_REENTER_PLAYING:2027,SC_CREATE_HALL_TABLE:2028,SC_JOIN_CUSTOM_TABLE:2029,SC_NEXT_CUSTOM_TABLE_GAME_START:2030,SC_CUSTOM_GAME_RESULT:2031,SC_TALK:2040,SC_BROADCAST:2041,SC_CHARGE:2050,SC_BUY:2052,SC_MAX:2999},sub_msg:{SUB_C_LAND_SCORE:1,SUB_C_OUT_CART:2,SUB_C_PASS_CARD:3,SUB_C_TRUSTEE:4,SUB_C_BRIGHT:5,SUB_C_DOUBLE:6,SUB_S_SEND_CARD:100,SUB_S_LAND_SCORE:101,SUB_S_GAME_START:102,SUB_S_OUT_CARD:103,SUB_S_PASS_CARD:104,SUB_S_GAME_END:105,SUB_S_USER_BRIGHT:106,SUB_S_USER_DOUBLE:107,SUB_S_SET_BASESCORE:108,SUB_S_TRUSTEE:109},error_code:{ERROR_OK:0,ERROR_NOT_ENOUTH_GOLD:1,ERROR_NOT_ENOUTH_BANK_GOLD:2,ERROR_INVAID_UID:3,ERROR_ROOM_IS_NOT_EXIST:4,ERROR_ROOM_IS_IN_ROOM:5,ERROR_ROOM_PLAYER_IS_FULL:6,ERROR_USER_PLAYING:7,ERROR_NO_TABLE:8,ERROR_OTHER_TABLE_SIT:9,ERROR_TABLE_BAN_SIT_DOWN:10,ERROR_GAME_IS_STARTED:11,ERROR_CHAIR_IS_SITTING:12,ERROR_GOLD_IS_NOT_ENOUGH:13,ERROR_LENGTH_TOO_LONG:14,ERROR_RATE_TIMEOUT:15,ERROR_RATE_REPEAT:16,ERROR_NAME_BAN_WORD:17,ERROR_PWD_WRONG:18,ERROR_ACCOUNT_EXIST:19,ERROR_CHAR_UNQUALIFIED:20,ERROR_INVAID_ACCOUNT:21,ERROR_IS_PLAYING:22,ERROR_GAME_IS_OVER:23,ERROR_CREATE_TABLE_PLEASE_CHAIR:24,ERROR_CREATE_HALL_TABLE_IS_NOT_OPEN:25,ERROR_SERVER_IS_BUSY:26,ERROR_CARD_IS_NOT_ENOUGH:27,ERROR_TABLE_IS_DISSOLVE:28,ERROR_PLEASE_STANDUP:29,ERROR_TABLE_IS_FULL:30,ERROR_TICKET_IS_NOT_ENOUGH:31,ERROR_CUSTOM_TABLE_IS_START:32},INVALID:65535,event:{network:{on_connect_succeed:"on_connect_succeed",on_connect_failed:"on_connect_failed",on_socket_error:"on_socket_error",on_connect_close:"on_server_close"},logic:{on_get_room_list:"on_get_room_list",on_player_data_update:"on_player_data_update",on_table_info_update:"on_table_info_update",on_query_room_info:"on_query_room_info",on_self_enter_room:"on_self_enter_room",on_self_leave_room:"on_self_leave_room",on_self_sit_down:"on_self_sit_down",on_self_stand_up:"on_self_stand_up",on_player_enter_room:"on_player_enter_room",on_player_leave_room:"on_player_leave_room",on_table_users_update:"on_table_users_update",on_create_custom_table:"on_create_custom_table",on_join_custom_table:"on_join_custom_table",on_new_chat_data:"on_new_chat_data",on_start_game:"on_start_game",on_exit_game:"on_exit_game"},doudizhu:{on_rec:"onrec"}}},msg_data=(_a={},_a[constant.msg.CS_PLATFORM_REGISTER]={ret:constant.msg.SC_PLATFORM_REGISTER},_a[constant.msg.CS_PLATFORM_LOGIN]={ret:constant.msg.SC_PLATFORM_LOGIN},_a[constant.msg.CS_PLATFORM_CHANGE_PWD]={ret:constant.msg.SC_PLATFORM_CHANGE_PWD},_a[constant.msg.CS_LOGIN]={ret:constant.msg.SC_LOGIN},_a[constant.msg.CS_CREATE_ROOM]={ret:constant.msg.SC_CREATE_ROOM},_a[constant.msg.CS_ENTER_ROOM]={ret:constant.msg.SC_ENTER_ROOM},_a[constant.msg.CS_LEAVE_ROOM]={ret:constant.msg.SC_LEAVE_ROOM},_a[constant.msg.CS_LOGOUT]={ret:constant.msg.SC_LOGOUT},_a[constant.msg.CS_SAVE_MONEY]={ret:constant.msg.SC_SAVE_MONEY},_a[constant.msg.CS_WITHDRAW_MONEY]={ret:constant.msg.SC_WITHDRAW_MONEY},_a[constant.msg.CS_GIVE_GOLD_2_OTHER]={ret:constant.msg.SC_GIVE_GOLD_2_OTHER},_a[constant.msg.CS_CHANGE_BANK_PASSWD]={ret:constant.msg.SC_CHANGE_BANK_PASSWD},_a[constant.msg.CS_GET_BANK_RECORD]={ret:constant.msg.SC_GET_BANK_RECORD},_a[constant.msg.CS_GET_RANK]={ret:constant.msg.SC_GET_RANK},_a[constant.msg.CS_QUERY_TABLE_USER_INFO]={ret:constant.msg.SC_TABLE_PLAYER_INFO},_a[constant.msg.CS_USER_SIT_DOWN]={ret:constant.msg.SC_USER_SIT_DOWN},_a[constant.msg.CS_USER_STAND_UP]={ret:constant.msg.SC_USER_STAND_UP},_a[constant.msg.CS_CHILD_GAME_MESSAGE]={ret:constant.msg.SC_CHILD_GAME_MESSAGE},_a[constant.msg.CS_QUERY_ROOM_INFO]={ret:constant.msg.SC_QUERY_ROOM_INFO},_a[constant.msg.CS_MODIFY_USER_INFO]={ret:constant.msg.SC_MODIFY_USER_INFO},_a[constant.msg.CS_REENTER_PLAYING]={ret:constant.msg.SC_REENTER_PLAYING},_a[constant.msg.CS_CREATE_HALL_TABLE]={ret:constant.msg.SC_CREATE_HALL_TABLE},_a[constant.msg.CS_JOIN_CUSTOM_TABLE]={ret:constant.msg.SC_JOIN_CUSTOM_TABLE},_a[constant.msg.CS_TALK]={ret:constant.msg.SC_TALK},_a[constant.msg.CS_CHARGE]={ret:constant.msg.SC_CHARGE},_a[constant.msg.CS_BUY]={ret:constant.msg.SC_BUY},_a),error_data=(_b={},_b[constant.error_code.ERROR_NOT_ENOUTH_GOLD]={msg:"金币不足"},_b[constant.error_code.ERROR_NOT_ENOUTH_BANK_GOLD]={msg:"银行金币不足"},_b[constant.error_code.ERROR_INVAID_UID]={msg:"错误的id"},_b[constant.error_code.ERROR_ROOM_IS_NOT_EXIST]={msg:"房间不存在"},_b[constant.error_code.ERROR_ROOM_IS_IN_ROOM]={msg:"玩家已在这个房间"},_b[constant.error_code.ERROR_ROOM_PLAYER_IS_FULL]={msg:"房间玩家已满"},_b[constant.error_code.ERROR_USER_PLAYING]={msg:"正在游戏进行中"},_b[constant.error_code.ERROR_NO_TABLE]={msg:"没有这个桌子"},_b[constant.error_code.ERROR_OTHER_TABLE_SIT]={msg:"你正在其他桌子，无法坐下"},_b[constant.error_code.ERROR_TABLE_BAN_SIT_DOWN]={msg:"当前桌子禁止用户进入"},_b[constant.error_code.ERROR_GAME_IS_STARTED]={msg:"游戏已经开始，不能进入"},_b[constant.error_code.ERROR_CHAIR_IS_SITTING]={msg:"这个位置已被别人捷足先登了"},_b[constant.error_code.ERROR_GOLD_IS_NOT_ENOUGH]={msg:"金币不足，无法进入"},_b[constant.error_code.ERROR_LENGTH_TOO_LONG]={msg:"获取记录长度过长"},_b[constant.error_code.ERROR_RATE_TIMEOUT]={msg:"评价超时"},_b[constant.error_code.ERROR_RATE_REPEAT]={msg:"重复评价"},_b[constant.error_code.ERROR_NAME_BAN_WORD]={msg:"名字包含非法字符"},_b[constant.error_code.ERROR_PWD_WRONG]={msg:"密码错误"},_b[constant.error_code.ERROR_ACCOUNT_EXIST]={msg:"帐号已存在"},_b[constant.error_code.ERROR_CHAR_UNQUALIFIED]={msg:"非法字符"},_b[constant.error_code.ERROR_INVAID_ACCOUNT]={msg:"帐号不合法，长度必须不小于6位"},_b[constant.error_code.ERROR_IS_PLAYING]={msg:"有游戏在进行中"},_b[constant.error_code.ERROR_GAME_IS_OVER]={msg:"游戏已结束"},_b[constant.error_code.ERROR_CREATE_TABLE_PLEASE_CHAIR]={msg:"请先离开座位再创建房间"},_b[constant.error_code.ERROR_CREATE_HALL_TABLE_IS_NOT_OPEN]={msg:"此游戏未开放开房间功能"},_b[constant.error_code.ERROR_SERVER_IS_BUSY]={msg:"服务器繁忙"},_b[constant.error_code.ERROR_CARD_IS_NOT_ENOUGH]={msg:"房卡不足"},_b[constant.error_code.ERROR_TABLE_IS_DISSOLVE]={msg:"房间已解散"},_b[constant.error_code.ERROR_PLEASE_STANDUP]={msg:"请先离开座位"},_b[constant.error_code.ERROR_TABLE_IS_FULL]={msg:"桌子人数已满"},_b[constant.error_code.ERROR_TICKET_IS_NOT_ENOUGH]={msg:"门票不足"},_b[constant.error_code.ERROR_CUSTOM_TABLE_IS_START]={msg:"游戏已开始,不能加入"},_b),_a,_b,gameUI;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e.isLoaded=!1,e}return __extends(e,t),e.prototype.onload=function(){this.isLoaded=!0,this.updateUI()},e.prototype.updateUI=function(){this.isLoaded&&null!=this.data&&(this.data.uid==PlayerManager.Instance.Data.UserId?(this.leftGroup.visible=!1,this.rightGroup.visible=!0,this.txtNameR.text=this.data.name,this.txtContentR.text=this.data.content,this.imgContentBgR.width=this.txtContentR.width+20):(this.leftGroup.visible=!0,this.rightGroup.visible=!1,this.txtNameL.text=this.data.name,this.txtContentL.text=this.data.content,this.imgContentBgL.width=this.txtContentL.width+20))},e.prototype.dataChanged=function(){this.updateUI()},e}(eui.ItemRenderer);__reflect(e.prototype,"chatItemRander");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.onload=function(){var n=this;t.prototype.onload.call(this),this.AddClick(this.btnClose,function(){n.Close()},this),this.svData.initItemRenderer(e),this.svData.initItemSkin("resource/custom_skins/chatItemSkin.exml"),this.svData.bindData(ChatManager.Instance.Messages),this.setScroll(),this.btnSend.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.txtInput.text.trim().length>0&&ChatManager.Instance.sendMsg(n.txtInput.text)},this),ChatManager.Instance.addEventListener(constant.event.logic.on_new_chat_data,this.onNewChat,this)},n.prototype.onUnload=function(){t.prototype.onUnload.call(this),ChatManager.Instance.removeEventListener(constant.event.logic.on_new_chat_data,this.onNewChat,this)},n.prototype.setScroll=function(){var t=this.svData.Scroller.viewport.contentHeight-this.svData.Scroller.viewport.height;t>-115&&(this.svData.Scroller.validateNow(),this.svData.Scroller.viewport.scrollV=this.svData.Scroller.viewport.contentHeight-this.svData.Scroller.viewport.height)},n.prototype.onNewChat=function(t){this.svData.bindData(ChatManager.Instance.Messages),this.setScroll()},n}(t.base);t.chat=n,__reflect(n.prototype,"gameUI.chat")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onload=function(){var e=this;t.prototype.onload.call(this),this.lblOk.text="确认修改",this.btnRegister.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return 0==e.txtCode.text.length||0==e.txtAccount.text.length||0==e.txtPassword.text.length?void UIManager.Instance.showNotice("手机号、密码、验证码不能为空"):void 0},this),this.btnGetcode.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.Instance.showNotice("假设已经发送了....")},this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.Close(),UIManager.Instance.LoadUI(UI.login)},this)},e}(t.base);t.forgetPwd=e,__reflect(e.prototype,"gameUI.forgetPwd")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onload=function(){t.prototype.onload.call(this)},e.prototype.setProgress=function(t){this.loadingFg.width=10*t,this.loadingPos.x=this.loadingFg.x+this.loadingFg.width-3,this.txtLoading.text="正在加载资源："+t+"%"},e}(t.base);t.loading=e,__reflect(e.prototype,"gameUI.loading")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.test=function(){for(var t=this.txtAccount.text.split(","),e=this.txtPassword.text.split(","),n=[],r=[],a=0;a<t.length;a++)n.push(Card.Util.createPokerCard(parseInt(t[a])));
for(var a=0;a<e.length;a++)r.push(Card.Util.createPokerCard(parseInt(e[a])));for(var o=new Card.ddzHandCards(n),i=new Card.ddzPackCardGroup(r),s=o.getPressedCards(i),c="",a=0;a<s.length;a++){for(var h="",d=0;d<s[a].length;d++)h+=s[a][d].Index.toString();c+=h+"\r\n"}UIManager.Instance.showNotice(c)},e.prototype.onload=function(){var e=this;t.prototype.onload.call(this),this.btnLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){ConnectionManager.Instance.isConnected?e.requestLogin():ConnectionManager.Instance.connect(constant.connect_ip,constant.connect_port,function(){e.requestLogin()},e)},this);var n=Util.getItem("username");null!=n&&(this.txtAccount.text=n);var r=Util.getItem("password");null!=r&&(this.txtPassword.text=r),this.btnWeixin.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.Instance.showNotice("暂未实现")},this),this.btnQQ.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.Instance.showNotice("暂未实现")},this),this.btnForgetPwd.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){ConnectionManager.Instance.isConnected?UIManager.Instance.LoadUI(UI.forgetPwd):ConnectionManager.Instance.connect(constant.connect_ip,constant.connect_port,function(){UIManager.Instance.LoadUI(UI.forgetPwd)},e)},this),this.btnRegister.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){ConnectionManager.Instance.isConnected?UIManager.Instance.LoadUI(UI.register):ConnectionManager.Instance.connect(constant.connect_ip,constant.connect_port,function(){UIManager.Instance.LoadUI(UI.register)},e)},this)},e.prototype.requestLogin=function(){LoginManager.Instance.loginPlatform(this.txtAccount.text,this.txtPassword.text,this.onLoginRet,this)},e.prototype.onLoginRet=function(t){var e=this;0==t.ret&&(Util.setItem("username",this.txtAccount.text),Util.setItem("password",this.txtPassword.text),this.Close(),UIManager.Instance.LoadUI(UI.loading,null,function(){var t=new egret.Timer(500,1);t.addEventListener(egret.TimerEvent.TIMER,function(){var t=UIManager.Instance.GetChild(UI.loading),n=["preload","lobby","common"];ResourceManager.Instance.loadGroups(n,e,function(){t.Close(),UIManager.Instance.LoadUI(UI.lobby)},function(e,n){t.setProgress(Math.floor(100*e/n))})},e),t.start()},this))},e}(t.base);t.login=e,__reflect(e.prototype,"gameUI.login")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onload=function(){var e=this;t.prototype.onload.call(this),this.btnModify.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return""==e.txtAccount.text.trim()?void UIManager.Instance.showNotice("请输入帐号"):""==e.txtOldPwd.text.trim()?void UIManager.Instance.showNotice("请输入原始密码"):""==e.txtNewPwd.text.trim()?void UIManager.Instance.showNotice("请输入新密码"):""==e.txtNewPwd2.text.trim()?void UIManager.Instance.showNotice("请再次输入新密码"):void LoginManager.Instance.changePlatformPwd(e.txtAccount.text.trim(),e.txtOldPwd.text.trim(),e.txtNewPwd.text.trim(),function(t){0==t.ret&&UIManager.Instance.showNotice("修改成功")},e)},this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.Close()},this)},e}(t.base);t.modifyPwd=e,__reflect(e.prototype,"gameUI.modifyPwd")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onload=function(){var e=this;t.prototype.onload.call(this),this.lblOk.text="登录注册",this.btnRegister.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return 0==e.txtCode.text.length||0==e.txtAccount.text.length||0==e.txtPassword.text.length?void UIManager.Instance.showNotice("手机号、密码、验证码不能为空"):void 0},this),this.btnGetcode.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.Instance.showNotice("假设已经发送了....")},this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.Close(),UIManager.Instance.LoadUI(UI.register)},this)},e}(t.base);t.phoneRegister=e,__reflect(e.prototype,"gameUI.phoneRegister")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isLoaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e.skinName="resource/custom_skins/rankItemSkin.exml",e}return __extends(e,t),e.prototype.onload=function(){this.isLoaded=!0,this.updateUI()},e.prototype.updateUI=function(){this.isLoaded&&null!=this.data&&(0==this.data.rank?(this.imgIndex.source="rank_1_png",this.imgBg.source="rank_bg2_png",this.txtIndex.visible=!1):1==this.data.rank?(this.imgIndex.source="rank_2_png",this.imgBg.source="rank_bg3_png",this.txtIndex.visible=!1):2==this.data.rank?(this.imgIndex.source="rank_3_png",this.imgBg.source="rank_bg4_png",this.txtIndex.visible=!1):(this.imgIndex.source="rank_index_png",this.imgBg.source="rank_bg4_png",this.txtIndex.visible=!0),this.txtName.text=this.data.name.toString(),this.txtValue.text=this.data.score.toString(),this.txtIndex.text=(this.data.rank+1).toString())},e.prototype.dataChanged=function(){this.updateUI()},e}(eui.ItemRenderer);__reflect(e.prototype,"rankItemRander");var n="rank_tab_png",r="rank_tab2_png",a=15897626,o=7819298,i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentTabIndex=-1,e}return __extends(i,t),i.prototype.onload=function(){var n=this;t.prototype.onload.call(this),this.AddClick(this.btnClose,function(){n.Close()},this),this.tabBtns=[this.btnGold,this.btnCredit,this.btnCharm],this.tabText=[this.lblGold,this.lblCredit,this.lblCharm],this.svData.initItemRenderer(e),this.svData.initItemSkin("resource/custom_skins/rankItemSkin.exml"),MessageManager.Instance.addEventListener(constant.msg.SC_GET_RANK,this.onGetRankList,this),this.btnGold.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.loadTab(0),n.getRankList(0,1)},this),this.btnCredit.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.loadTab(1),n.getRankList(0,2)},this),this.loadTab(0),this.getRankList(0,1)},i.prototype.onUnload=function(){t.prototype.onUnload.call(this),MessageManager.Instance.removeEventListener(constant.msg.SC_GET_RANK,this.onGetRankList,this)},i.prototype.loadTab=function(t){if(this.currentTabIndex!=t){this.currentTabIndex=t;for(var e=0;3>e;e++)e==this.currentTabIndex?(this.tabBtns[e].source=n,this.tabText[e].textColor=a):(this.tabBtns[e].source=r,this.tabText[e].textColor=o)}},i.prototype.getRankList=function(t,e){MessageManager.Instance.SendMessage({protocol:constant.msg.CS_GET_RANK,begin:t,type:e})},i.prototype.onGetRankList=function(t){this.svData.bindData(t.rank),1==t.type?this.txtScore.text="金币":2==t.type&&(this.txtScore.text="信用")},i}(t.base);t.rank=i,__reflect(i.prototype,"gameUI.rank")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onload=function(){var e=this;t.prototype.onload.call(this),this.btnRegister.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return e.account=e.txtAccount.text,e.password=e.txtPassword.text,0==e.account.trim().length||0==e.password.trim().length?void UIManager.Instance.showNotice("请输入帐号和密码"):void LoginManager.Instance.registerPlatform(e.account,e.password,e.onRegister,e)},this),this.btnWeixin.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.Instance.showNotice("暂未实现")},this),this.btnQQ.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.Instance.showNotice("暂未实现")},this),this.btnPhone.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.Instance.LoadUI(UI.phoneRegister)},this),this.btnFanqi.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.Instance.showNotice("暂未实现")},this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.Close(),UIManager.Instance.LoadUI(UI.login)},this)},e.prototype.onRegister=function(t){var e=this;0==t.ret&&LoginManager.Instance.loginPlatform(this.account,this.password,function(t){0==t.ret&&(Util.setItem("username",e.account),Util.setItem("password",e.password),UIManager.Instance.LoadUI(UI.loading,null,function(){var t=new egret.Timer(500,1);t.addEventListener(egret.TimerEvent.TIMER,function(){var t=UIManager.Instance.GetChild(UI.loading),n=["preload","lobby","common"];ResourceManager.Instance.loadGroups(n,e,function(){t.Close(),UIManager.Instance.LoadUI(UI.lobby)},function(e,n){t.setProgress(Math.floor(100*e/n))})},e),t.start()},e))},this)},e}(t.base);t.register=e,__reflect(e.prototype,"gameUI.register")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isLoaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e.skinName="resource/custom_skins/settingLanguageItem.exml",e.isLoaded=!1,e}return __extends(e,t),e.prototype.onload=function(){var t=this;this.isLoaded=!0,this.txtLan.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var e=UIManager.Instance.GetChild(UI.setting);null!=e&&e.onSelectLanguage(t.data.text)},this),this.updateUI()},e.prototype.updateUI=function(){this.isLoaded&&null!=this.data&&(this.txtLan.text=this.data.text)},e.prototype.dataChanged=function(){this.updateUI()},e}(eui.ItemRenderer);__reflect(e.prototype,"settingLanguageItemRander");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.onload=function(){var n=this;t.prototype.onload.call(this),this.AddClick(this.btnClose,function(){n.Close()},this);var r=[{text:"中文"},{text:"英文"},{text:"日文"},{text:"鸟语"},{text:"兽语"}];this.svData.initItemRenderer(e),this.svData.bindData(r),this.imgSelect.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.svData.visible=!n.svData.visible},this),this.svData.visible=!1},n.prototype.onSelectLanguage=function(t){this.txtLang.text=t,this.svData.visible=!1},n}(t.base);t.setting=n,__reflect(n.prototype,"gameUI.setting")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isLoaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e.skinName="resource/custom_skins/shopItemSkin.exml",e}return __extends(e,t),e.prototype.getImg=function(t){var e="jinbi2_png";switch(t){case 1001:e="jinbi2_png";break;case 1002:e="fangka2_png";break;case 4001:e="jipaiqi_png";break;case 4002:e="shopexp_png";break;case 4003:e="jipaiqi_png";break;case 4004:e="shopexp_png"}return e},e.prototype.onload=function(){var t=this;this.isLoaded=!0,this.updateUI(),this.btnSelect.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.data instanceof ChargeData?PlayerManager.Instance.Charge(t.data.rmb):t.data instanceof ShopData&&PlayerManager.Instance.BuyItem(t.data.id)},this)},e.prototype.updateUI=function(){this.isLoaded&&null!=this.data&&(this.data instanceof ChargeData?(this.txtTitle.text=this.data.num.toString(),this.txtNum.text=this.data.rmb.toString()+"元",this.txtPresent.text="额外赠送"+this.data.giveNum+this.data.giveItem.name,this.lblHot.text="限时",this.imgItem.source=this.getImg(this.data.item.id)):this.data instanceof ShopData&&(this.txtTitle.text=this.data.item.name,this.txtNum.text=this.data.item.price.toString(),this.txtPresent.text="",this.lblHot.text="热卖",this.imgItem.source=this.getImg(this.data.item.id)))},e.prototype.dataChanged=function(){this.updateUI()},e}(eui.ItemRenderer);__reflect(e.prototype,"shopItemRander");var n="shopbtnTab_png",r="goumaidaoju_png",a=15897626,o=7819298,i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentTabIndex=-1,e.chargeDatas=[],e.shopDatas=[],e}return __extends(i,t),i.prototype.onload=function(){var n=this;t.prototype.onload.call(this),this.AddClick(this.btnClose,function(){n.Close()},this),this.tabBtns=[this.btnCharge,this.btnBuy],this.tabText=[this.lblCgarge,this.lblbuy],this.dataList.itemRenderer=e,this.listView.viewport=this.dataList;var r=new eui.TileLayout;r.columnWidth=210,r.rowHeight=260,this.dataList.layout=r,r.requestedColumnCount=4;var a=DataManager.Instance.getJsonData("items");this.chargeDatas=[];for(var o in a.Recharge){var i=new ChargeData(a.Recharge[o]);this.chargeDatas.push(i)}this.shopDatas=[];for(var o in a.Shop){var s=new ShopData(a.Shop[o]);this.shopDatas.push(s)}this.btnCharge.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.loadTab(0),n.loadData(n.chargeDatas)},this),this.btnBuy.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.loadTab(1),n.loadData(n.shopDatas)},this),this.loadTab(0),this.loadData(this.chargeDatas)},i.prototype.onUnload=function(){t.prototype.onUnload.call(this)},i.prototype.loadData=function(t){this.dataList.dataProvider=new eui.ArrayCollection(t),this.listView.horizontalScrollBar=null,this.listView.verticalScrollBar=null},i.prototype.loadTab=function(t){if(this.currentTabIndex!=t){this.currentTabIndex=t;for(var e=0;2>e;e++)e==this.currentTabIndex?(this.tabBtns[e].source=n,this.tabText[e].textColor=a):(this.tabBtns[e].source=r,this.tabText[e].textColor=o)}},i}(t.base);t.shop=i,__reflect(i.prototype,"gameUI.shop")}(gameUI||(gameUI={}));var gameUI;!function(t){var e;!function(t){t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal",t[t.Tile=2]="Tile"}(e=t.ScrollLayout||(t.ScrollLayout={}));var n=function(t){function n(){var n=t.call(this)||this;return n.dataList=null,n.isLoaded=!1,n.itemRenderer=null,n.itemSkinName=null,n.isLoaded=!1,n.itemSkinName=null,n.itemRenderer=null,n.data=null,n.scrollLayout=e.Vertical,n.addEventListener(eui.UIEvent.COMPLETE,n.onload,n),n.skinName="resource/custom_skins/controls/ScrollviewSkin.exml",n}return __extends(n,t),n.prototype.onload=function(){this.isLoaded=!0,this.sv.viewport=this.dataList,this.initScrollLayout(this.scrollLayout),null!=this.itemSkinName&&this.initItemSkin(this.itemSkinName),null!=this.itemRenderer&&this.initItemRenderer(this.itemRenderer),null!=this.data&&this.bindData(this.data)},n.prototype.initScrollLayout=function(t){if(this.scrollLayout=t,this.isLoaded){var n;this.scrollLayout==e.Vertical?(n=new eui.VerticalLayout,this.sv.scrollPolicyH="off",this.sv.scrollPolicyV="on"):(n=new eui.HorizontalLayout,this.sv.scrollPolicyH="on",this.sv.scrollPolicyV="off"),n.gap=0,n.horizontalAlign=egret.HorizontalAlign.CONTENT_JUSTIFY,this.dataList.layout=n}},n.prototype.initItemSkin=function(t){this.itemSkinName=t,this.isLoaded&&(this.dataList.itemRendererSkinName=this.itemSkinName)},n.prototype.initItemRenderer=function(t){this.itemRenderer=t,this.isLoaded&&(this.dataList.itemRenderer=this.itemRenderer)},n.prototype.bindData=function(t){this.data=t,this.isLoaded&&(this.dataList.dataProvider=new eui.ArrayCollection(this.data),this.sv.horizontalScrollBar=null,this.sv.verticalScrollBar=null)},Object.defineProperty(n.prototype,"DataList",{get:function(){return this.dataList},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Scroller",{get:function(){return this.sv},enumerable:!0,configurable:!0}),n}(eui.Component);t.Scrollview=n,__reflect(n.prototype,"gameUI.Scrollview")}(gameUI||(gameUI={}));var gameUIControl;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._value=0,e.addEventListener(eui.UIEvent.COMPLETE,e.onLoad,e),e}return __extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value<0&&(this._value=0),this._value>1&&(this._value=1),this._value},enumerable:!0,configurable:!0}),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.onLoad=function(){var t=this;this.bg.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(e){e.touchDown&&e.localX>0&&e.localX<t.bg.width&&(t.thumb.x=e.localX,t.fg.width=e.localX,t._value=e.localX/t.fg.width)},this)},e}(eui.Component);t.Slider=e,__reflect(e.prototype,"gameUIControl.Slider")}(gameUIControl||(gameUIControl={}));var gameUI;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isLoaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e.skinName="resource/custom_skins/games/ddzRoomTableSkin.exml",e}return __extends(e,t),e.prototype.onload=function(){var t=this;this.isLoaded=!0,this.updateUI(),this.btnEnter1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.sitDown(0)},this),this.btnEnter2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.sitDown(1)},this),this.btnEnter3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.sitDown(2)},this)},e.prototype.sitDown=function(t){return null!=this.data.Users[t]&&void 0!=this.data.Users[t]?void UIManager.Instance.showNotice("有人坐了，请选其他位置"):void RoomManager.Instance.SitDown(this.data.TableId,t)},e.prototype.updateUI=function(){if(this.isLoaded&&null!=this.data){for(var t=!0,e=[this.imgUser1,this.imgUser2,this.imgUser3],n=0;2>=n;n++){var r=this.data.Users[n];null!=r&&void 0!=r?e[n].visible=!0:(e[n].visible=!1,t=!1)}this.txtTableNum.text=this.data.TableId.toString()+"号桌",t?this.txtStatus.text="进行中":this.txtStatus.text="等待中"}},e.prototype.dataChanged=function(){this.updateUI()},e}(eui.ItemRenderer);__reflect(e.prototype,"ddzRoomItemRander");var n=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.onload=function(){n.prototype.onload.call(this),UIManager.Instance.Lobby.groupType.visible=!1,UIManager.Instance.Lobby.groupTopMenu.visible=!1,UIManager.Instance.Lobby.imgBg.source="background2_png",this.svGame.initScrollLayout(t.ScrollLayout.Horizontal),this.svGame.initItemRenderer(e),this.AddClick(this.btnClose,function(){RoomManager.Instance.LevelRoom()},this),this.AddClick(this.btnQuickStart,function(){},this),RoomManager.Instance.addEventListener(constant.event.logic.on_self_sit_down,this.onSitDown,this),RoomManager.Instance.addEventListener(constant.event.logic.on_self_leave_room,this.onLeaveRoom,this),RoomManager.Instance.addEventListener(constant.event.logic.on_query_room_info,this.onQueryRoomInfo,this),this.enterRoomData=null,RoomManager.Instance.queryRoomInfo()},r.prototype.onUnload=function(){n.prototype.onUnload.call(this),RoomManager.Instance.removeEventListener(constant.event.logic.on_self_sit_down,this.onSitDown,this),RoomManager.Instance.removeEventListener(constant.event.logic.on_self_leave_room,this.onLeaveRoom,this),RoomManager.Instance.removeEventListener(constant.event.logic.on_query_room_info,this.onQueryRoomInfo,this),this.enterRoomData&&this.enterRoomData.removeEventListener(constant.event.logic.on_table_users_update,this.onTableUserUpdate,this),this.enterRoomData=null,UIManager.Instance.Lobby.groupType.visible=!0,UIManager.Instance.Lobby.groupTopMenu.visible=!0,UIManager.Instance.Lobby.imgBg.source=UIManager.Instance.Lobby.defaultBackground},r.prototype.onQueryRoomInfo=function(t){this.enterRoomData=t,this.enterRoomData.addEventListener(constant.event.logic.on_table_users_update,this.onTableUserUpdate,this),this.svGame.bindData(this.enterRoomData.Tables)},r.prototype.onSitDown=function(t){GameManager.Instance.startDDZGame()},r.prototype.onLeaveRoom=function(t){this.Close()},r.prototype.onTableUserUpdate=function(t){for(var e=0;e<this.svGame.DataList.numChildren;e++){var n=this.svGame.DataList.getChildAt(e);n.data.TableId==t.TableId&&n.updateUI()}},r}(t.base);t.ddzRoom=n,__reflect(n.prototype,"gameUI.ddzRoom")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isLoaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e.skinName="resource/custom_skins/games/ddzSelectRoomItemSkin.exml",e}return __extends(e,t),e.prototype.onload=function(){this.isLoaded=!0,this.imgBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.updateUI()},e.prototype.updateUI=function(){this.isLoaded&&null!=this.data&&(this.txtName.text=this.data.Name,this.txtEnterGold.text=this.data.BaseScore)},e.prototype.onClick=function(){PlayerManager.Instance.Data.Gold>=this.data.Limit?RoomManager.Instance.EnterRoom(this.data.RoomId):UIManager.Instance.showNotice("金币不够")},e.prototype.dataChanged=function(){this.updateUI()},e}(eui.ItemRenderer);__reflect(e.prototype,"ddzSelectRoomItemRander");var n=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.onload=function(){var r=this;n.prototype.onload.call(this),UIManager.Instance.Lobby.groupType.visible=!1,UIManager.Instance.Lobby.groupTopMenu.visible=!1,this.svGame.initScrollLayout(t.ScrollLayout.Horizontal),this.svGame.initItemRenderer(e),this.svGame.bindData(RoomManager.Instance.RoomList),this.AddClick(this.btnClose,function(){r.Close()},this),RoomManager.Instance.addEventListener(constant.event.logic.on_self_enter_room,this.onEnterRoom,this)},r.prototype.onUnload=function(){n.prototype.onUnload.call(this),UIManager.Instance.Lobby.groupType.visible=!0,UIManager.Instance.Lobby.groupTopMenu.visible=!0,RoomManager.Instance.removeEventListener(constant.event.logic.on_self_enter_room,this.onEnterRoom,this)},r.prototype.onEnterRoom=function(t){this.Close(),UIManager.Instance.LoadUI(UI.ddzRoom)},r}(t.base);t.ddzSelectRoom=n,__reflect(n.prototype,"gameUI.ddzSelectRoom")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(){function t(t){this.rounds=[],this.multiple=[],this.costs=[],this.gameId=101,this.rounds=t.GameNum,this.multiple=t.set1,this.costs=[{itemId:t.HallCost[0],num:t.HallCost[1]},{itemId:t.HallCost[2],num:t.HallCost[3]}]}return t}();__reflect(e.prototype,"DdzSettingData");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.onload=function(){var n=this;t.prototype.onload.call(this);var r=DataManager.Instance.getJsonData("hall");this.ddzSettdata=new e(r.Game[101]),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.Close()},this),this.btnCreate.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var t=8;t=n.ddzrbtnRound1.selected?n.ddzSettdata.rounds[0]:n.ddzSettdata.rounds[1];var e,r,a=1;n.ddzrbtnRoommdl1.selected?(a=1,e=n.ddzSettdata.costs[0].itemId,r=n.ddzSettdata.costs[0].num):(a=2,e=n.ddzSettdata.costs[1].itemId,r=n.ddzSettdata.costs[1].num);var o=120;o=n.ddzrbtntimes1.selected?n.ddzSettdata.multiple[0]:n.ddzSettdata.multiple[1],PlayerManager.Instance.Data.getResourceNumById(e)>=r?RoomManager.Instance.CreateCustomTable(n.ddzSettdata.gameId,a,t,o):UIManager.Instance.showNotice("道具不足")},this),this.initDDZUI(),RoomManager.Instance.addEventListener(constant.event.logic.on_create_custom_table,this.onCreateCustomTable,this)},n.prototype.onUnload=function(){t.prototype.onUnload.call(this),RoomManager.Instance.removeEventListener(constant.event.logic.on_create_custom_table,this.onCreateCustomTable,this)},n.prototype.onCreateCustomTable=function(t){0==t.ret&&(UIManager.Instance.showNotice("创建成功！房间号："+t.custom_table_id),this.Close())},n.prototype.initDDZUI=function(){this.ddzrbtnRound1.label=this.ddzSettdata.rounds[0]+"局",this.ddzrbtnRound2.label=this.ddzSettdata.rounds[1]+"局",this.ddzrbtnRoommdl1.label="房主开房",this.ddzrbtnRoommdl2.label="AA开房",this.ddzrbtntimes1.label=this.ddzSettdata.multiple[0]+"倍",this.ddzrbtntimes2.label=this.ddzSettdata.multiple[1]+"倍"},n}(t.base);t.create_room=n,__reflect(n.prototype,"gameUI.create_room")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numbers=[],e}return __extends(e,t),e.prototype.onload=function(){var e=this;t.prototype.onload.call(this),this.btnCreateRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.Instance.LoadUI(UI.create_room)},this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.Close()},this),this.btnReinput.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.numbers=[],e.updateUI()},this),this.btnDel.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.numbers.length>0&&(e.numbers.splice(e.numbers.length-1,1),e.updateUI())},this),this.btn0.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.input(0)},this),this.btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.input(1)},this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.input(2)},this),this.btn3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.input(3)},this),this.btn4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.input(4)},this),this.btn5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.input(5)},this),this.btn6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.input(6)},this),this.btn7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.input(7)},this),this.btn8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.input(8)},this),this.btn9.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.input(9)},this),RoomManager.Instance.addEventListener(constant.event.logic.on_join_custom_table,this.onJoinCustomTable,this)},e.prototype.onUnload=function(){t.prototype.onUnload.call(this),RoomManager.Instance.removeEventListener(constant.event.logic.on_join_custom_table,this.onJoinCustomTable,this)},e.prototype.input=function(t){this.numbers.length<4&&(this.numbers.push(t),this.updateUI(),4==this.numbers.length&&this.enterRoom())},e.prototype.updateUI=function(){if(0==this.numbers.length)this.txtRoomNum.text="输　　入　　房　　号";else{for(var t=this.numbers[0].toString(),e=1;4>e;e++)t+=this.numbers.length>e?"　　 "+this.numbers[e].toString():"　　  ";this.txtRoomNum.text=t}},e.prototype.enterRoom=function(){if(4==this.numbers.length){var t=1e3*this.numbers[0]+100*this.numbers[1]+10*this.numbers[2]+this.numbers[3];RoomManager.Instance.JoinCustomTable(t)}},e.prototype.onJoinCustomTable=function(t){var e=this;0==t.ret&&(GameManager.Instance.once(constant.event.logic.on_start_game,function(){e.Close()},this),GameManager.Instance.startDDZGame())},e}(t.base);t.enter_room=e,__reflect(e.prototype,"gameUI.enter_room")}(gameUI||(gameUI={}));var gameUI;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isLoaded=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onload,e),e.skinName="resource/custom_skins/game_itemSkin.exml",e}return __extends(e,t),e.prototype.onload=function(){this.isLoaded=!0,this.imgBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.updateUI()},e.prototype.onClick=function(){101==this.data.ID?UIManager.Instance.LoadUI(UI.ddzSelectRoom):UIManager.Instance.showNotice("暂未开放功能")},e.prototype.updateUI=function(){null!=this.data&&this.isLoaded&&(this.txtName.text=this.data.Name1)},e.prototype.dataChanged=function(){this.updateUI()},e}(eui.ItemRenderer);__reflect(e.prototype,"game_item");var n=function(n){function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.defaultBackground="background_png",t}return __extends(r,n),r.prototype.onload=function(){var r=this;n.prototype.onload.call(this);var a=DataManager.Instance.getGames();this.svGame.initScrollLayout(t.ScrollLayout.Horizontal),this.svGame.initItemRenderer(e),this.svGame.bindData(a[1]),this.AddClick(this.btnPuke,function(){r.svGame.bindData(a[1])},this),this.AddClick(this.btnMajiang,function(){r.svGame.bindData(a[2])},this),this.AddClick(this.btnQilei,function(){r.svGame.bindData(a[3])},this),this.AddClick(this.imgMore,function(){},this),this.AddClick(this.imgNotice,function(){},this),this.AddClick(this.imgActivity,function(){},this),this.AddClick(this.imgHelp,function(){},this),this.AddClick(this.imgBank,function(){UIManager.Instance.LoadUI(UI.bank)},this),this.AddClick(this.imgRank,function(){UIManager.Instance.LoadUI(UI.rank)},this),this.AddClick(this.imgCommunity,function(){},this),this.AddClick(this.imgShare,function(){},this),this.AddClick(this.imgShop,function(){UIManager.Instance.LoadUI(UI.shop)},this),this.AddClick(this.imgSetting,function(){UIManager.Instance.LoadUI(UI.setting)},this),this.AddClick(this.btnEnter,function(){UIManager.Instance.LoadUI(UI.enter_room)},this),this.imgHeadIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this),this.AddClick(this.imgCoypBg,function(){},this),this.imgMsgBg.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.Instance.LoadUI(UI.chat)},this),PlayerManager.Instance.addEventListener(constant.event.logic.on_player_data_update,this.updatePlayerInfo,this),this.updatePlayerInfo(PlayerManager.Instance.Data),this.imgBg.source=this.defaultBackground},r.prototype.onUnload=function(){n.prototype.onUnload.call(this),PlayerManager.Instance.removeEventListener(constant.event.logic.on_player_data_update,this.updatePlayerInfo,this)},r.prototype.updatePlayerInfo=function(t){this.txtUsrId.text="ID:"+t.UserId.toString(),this.txtGoldNum.text=t.Gold.toString(),this.txtFbNum.text=t.Cardnum.toString(),this.txtUserName.text=t.Name.toString()},r}(t.base);t.lobby=n,__reflect(n.prototype,"gameUI.lobby")}(gameUI||(gameUI={}));